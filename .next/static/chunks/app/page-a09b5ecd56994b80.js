(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{296:function(e,t,a){Promise.resolve().then(a.bind(a,6874))},6874:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return Home}});var r=a(7437),n=a(2265),s=a(4301),i=a(8203),l=a(5750),c=a(3296),d=a(9617),o=a(5367),m=a(1865),x=a(8110),u=a(2160);function ParticipantsTable(e){let{trainingInvoiceId:t}=e,[a,s]=(0,n.useState)([]),[i,l]=(0,n.useState)(!0),[c,d]=(0,n.useState)(null),[o,m]=(0,n.useState)({name:"",email:"",company:""}),[x,u]=(0,n.useState)(null),[p,h]=(0,n.useState)({name:"",email:"",company:""}),fetchParticipants=async()=>{l(!0);try{let e=await fetch("/api/participants?training_invoice_id=".concat(t)),a=await e.json();a.success?s(a.data):d(a.error||"Failed to fetch participants")}catch(e){d("Failed to fetch participants")}finally{l(!1)}};(0,n.useEffect)(()=>{fetchParticipants()},[t]);let handleAdd=async e=>{e.preventDefault(),d(null);try{let e=await fetch("/api/participants?training_invoice_id=".concat(t),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)}),r=await e.json();r.success?(s([...a,r.data]),m({name:"",email:"",company:""})):d(r.error||"Failed to add participant")}catch(e){d("Failed to add participant")}},handleEdit=e=>{u(e.id),h({name:e.name,email:e.email,company:e.company})},handleEditSave=async e=>{d(null);try{let t=await fetch("/api/participants/".concat(e),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(p)}),r=await t.json();r.success?(s(a.map(t=>t.id===e?r.data:t)),u(null)):d(r.error||"Failed to update participant")}catch(e){d("Failed to update participant")}},handleDelete=async e=>{d(null);try{let t=await fetch("/api/participants/".concat(e),{method:"DELETE"}),r=await t.json();r.success?s(a.filter(t=>t.id!==e)):d(r.error||"Failed to delete participant")}catch(e){d("Failed to delete participant")}};return(0,r.jsxs)("div",{className:"mt-8",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Participants"}),c&&(0,r.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-2 mb-2 text-red-800",children:c}),(0,r.jsxs)("form",{onSubmit:handleAdd,className:"mb-4 flex flex-col md:flex-row gap-2",children:[(0,r.jsx)("input",{type:"text",placeholder:"Name",className:"input-field text-black",value:o.name,onChange:e=>m({...o,name:e.target.value}),required:!0}),(0,r.jsx)("input",{type:"email",placeholder:"Email",className:"input-field text-black",value:o.email,onChange:e=>m({...o,email:e.target.value}),required:!0}),(0,r.jsx)("input",{type:"text",placeholder:"Company",className:"input-field text-black",value:o.company,onChange:e=>m({...o,company:e.target.value}),required:!0}),(0,r.jsx)("button",{type:"submit",className:"btn-primary",children:"Add"})]}),(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,r.jsx)("thead",{className:"bg-gray-50",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider text-black",children:"Name"}),(0,r.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider text-black",children:"Email"}),(0,r.jsx)("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider text-black",children:"Company"}),(0,r.jsx)("th",{className:"px-4 py-2 text-right text-xs font-medium text-gray-500 uppercase tracking-wider text-black",children:"Actions"})]})}),(0,r.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:i?(0,r.jsx)("tr",{children:(0,r.jsx)("td",{colSpan:4,className:"text-center py-4",children:"Loading..."})}):0===a.length?(0,r.jsx)("tr",{children:(0,r.jsx)("td",{colSpan:4,className:"text-center py-4 text-gray-500",children:"No participants"})}):a.map(e=>(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{className:"px-4 py-2 text-black",children:x===e.id?(0,r.jsx)("input",{type:"text",className:"input-field text-black",value:p.name,onChange:e=>h({...p,name:e.target.value}),required:!0}):e.name}),(0,r.jsx)("td",{className:"px-4 py-2 text-black",children:x===e.id?(0,r.jsx)("input",{type:"email",className:"input-field text-black",value:p.email,onChange:e=>h({...p,email:e.target.value}),required:!0}):e.email}),(0,r.jsx)("td",{className:"px-4 py-2 text-black",children:x===e.id?(0,r.jsx)("input",{type:"text",className:"input-field text-black",value:p.company,onChange:e=>h({...p,company:e.target.value}),required:!0}):e.company}),(0,r.jsx)("td",{className:"px-4 py-2 text-right text-black",children:x===e.id?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("button",{className:"btn-primary mr-2",onClick:()=>handleEditSave(e.id),children:"Save"}),(0,r.jsx)("button",{className:"btn-secondary",onClick:()=>u(null),children:"Cancel"})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("button",{className:"btn-secondary mr-2",onClick:()=>handleEdit(e),children:"Edit"}),(0,r.jsx)("button",{className:"btn-danger",onClick:()=>handleDelete(e.id),children:"Delete"})]})})]},e.id))})]})})]})}var p=a(2549),h=a(8253),g=a(6523),y=a(2126);function TrainingDayOptionsModal(e){var t,a,s;let{isOpen:i,onClose:l,trainingDay:c,onSave:d}=e,[o,m]=(0,n.useState)([]),[x,u]=(0,n.useState)([]),[f,b]=(0,n.useState)(!0),[j,v]=(0,n.useState)({room_rent_option_id:c.room_rent_option_id,lunch_catering_option_id:c.lunch_catering_option_id,dinner_catering_option_id:c.dinner_catering_option_id});(0,n.useEffect)(()=>{i&&(fetchOptions(),v({room_rent_option_id:c.room_rent_option_id,lunch_catering_option_id:c.lunch_catering_option_id,dinner_catering_option_id:c.dinner_catering_option_id}))},[i,c]);let fetchOptions=async()=>{b(!0);try{let[e,t]=await Promise.all([fetch("/api/training-room-rent-options"),fetch("/api/catering-options")]),a=await e.json(),r=await t.json();a.success&&m(a.data),r.success&&u(r.data)}catch(e){console.error("Failed to fetch options:",e)}finally{b(!1)}},getSelectedRoomName=()=>{let e=o.find(e=>e.id===j.room_rent_option_id);return e?"".concat(e.name," (€").concat(e.rent_per_hour.toFixed(2),"/hr)"):"No room selected"},getSelectedLunchName=()=>{let e=x.find(e=>e.id===j.lunch_catering_option_id);return e?"".concat(e.name," (€").concat(e.lunch_price_per_participant.toFixed(2),")"):"No lunch selected"},getSelectedDinnerName=()=>{let e=x.find(e=>e.id===j.dinner_catering_option_id);return e?"".concat(e.name," (€").concat(e.dinner_price_per_participant.toFixed(2),")"):"No dinner selected"};return i?(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-2xl mx-4 max-h-[90vh] overflow-y-auto",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Training Day Options"}),(0,r.jsxs)("p",{className:"text-sm text-gray-600",children:[(e=>{if(!e)return"";let t=new Date(e);return t.toLocaleDateString("en-GB",{weekday:"long",year:"numeric",month:"long",day:"numeric"})})(c.date)," • ",c.start_time," - ",c.end_time]})]}),(0,r.jsx)("button",{onClick:l,className:"text-gray-400 hover:text-gray-600",children:(0,r.jsx)(p.Z,{className:"h-6 w-6"})})]}),f?(0,r.jsxs)("div",{className:"flex items-center justify-center py-8",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"}),(0,r.jsx)("span",{className:"ml-2 text-gray-600",children:"Loading options..."})]}):(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex items-center mb-3",children:[(0,r.jsx)(h.Z,{className:"h-5 w-5 text-gray-500 mr-2"}),(0,r.jsx)("h4",{className:"text-md font-medium text-gray-900",children:"Training Room"})]}),(0,r.jsxs)("select",{className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-primary-500 focus:border-primary-500",value:null!==(t=j.room_rent_option_id)&&void 0!==t?t:"",onChange:e=>v(t=>({...t,room_rent_option_id:e.target.value?Number(e.target.value):null})),children:[(0,r.jsx)("option",{value:"",children:"Select a training room"}),o.map(e=>(0,r.jsxs)("option",{value:e.id,children:[e.name," - €",e.rent_per_hour.toFixed(2),"/hour"]},e.id))]}),j.room_rent_option_id&&(0,r.jsxs)("p",{className:"mt-2 text-sm text-gray-600",children:["Selected: ",getSelectedRoomName()]})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex items-center mb-3",children:[(0,r.jsx)(g.Z,{className:"h-5 w-5 text-gray-500 mr-2"}),(0,r.jsx)("h4",{className:"text-md font-medium text-gray-900",children:"Lunch Catering"})]}),(0,r.jsxs)("select",{className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-primary-500 focus:border-primary-500",value:null!==(a=j.lunch_catering_option_id)&&void 0!==a?a:"",onChange:e=>v(t=>({...t,lunch_catering_option_id:e.target.value?Number(e.target.value):null})),children:[(0,r.jsx)("option",{value:"",children:"No lunch catering"}),x.map(e=>(0,r.jsxs)("option",{value:e.id,children:[e.name," - €",e.lunch_price_per_participant.toFixed(2)," per participant"]},e.id))]}),j.lunch_catering_option_id&&(0,r.jsxs)("p",{className:"mt-2 text-sm text-gray-600",children:["Selected: ",getSelectedLunchName()]})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex items-center mb-3",children:[(0,r.jsx)(y.Z,{className:"h-5 w-5 text-gray-500 mr-2"}),(0,r.jsx)("h4",{className:"text-md font-medium text-gray-900",children:"Dinner Catering"})]}),(0,r.jsxs)("select",{className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-primary-500 focus:border-primary-500",value:null!==(s=j.dinner_catering_option_id)&&void 0!==s?s:"",onChange:e=>v(t=>({...t,dinner_catering_option_id:e.target.value?Number(e.target.value):null})),children:[(0,r.jsx)("option",{value:"",children:"No dinner catering"}),x.map(e=>(0,r.jsxs)("option",{value:e.id,children:[e.name," - €",e.dinner_price_per_participant.toFixed(2)," per participant"]},e.id))]}),j.dinner_catering_option_id&&(0,r.jsxs)("p",{className:"mt-2 text-sm text-gray-600",children:["Selected: ",getSelectedDinnerName()]})]}),(0,r.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,r.jsx)("h5",{className:"text-sm font-medium text-gray-900 mb-2",children:"Summary"}),(0,r.jsxs)("div",{className:"space-y-1 text-sm text-gray-600",children:[(0,r.jsxs)("div",{children:["• Room: ",getSelectedRoomName()]}),(0,r.jsxs)("div",{children:["• Lunch: ",getSelectedLunchName()]}),(0,r.jsxs)("div",{children:["• Dinner: ",getSelectedDinnerName()]})]})]})]}),(0,r.jsxs)("div",{className:"flex justify-end space-x-3 pt-6 border-t mt-6",children:[(0,r.jsx)("button",{type:"button",onClick:l,className:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50",children:"Cancel"}),(0,r.jsx)("button",{type:"button",onClick:()=>{d(j),l()},className:"px-4 py-2 bg-primary-600 text-white rounded-md text-sm font-medium hover:bg-primary-700",children:"Save Options"})]})]})}):null}let f=u.Ry({invoice_number:u.Z_().optional(),invoice_date:u.Z_().optional(),customer:u.Z_().min(1,"Customer is required"),training_name:u.Z_().min(1,"Training name is required"),training_dates:u.IX(u.Ry({date:u.Z_().min(1,"Date is required"),start_time:u.Z_().min(1,"Start time is required"),end_time:u.Z_().min(1,"End time is required"),room_rent_option_id:u.Rx().nullable().optional(),lunch_catering_option_id:u.Rx().nullable().optional(),dinner_catering_option_id:u.Rx().nullable().optional()})).min(1,"At least one date is required"),trainer_costs:u.Rx().min(0,"Trainer costs must be non-negative"),office_costs:u.Rx().min(0,"Office costs must be non-negative"),margin_percentage:u.Rx().min(0,"Margin percentage must be non-negative"),total_invoice_amount:u.Rx().min(0,"Total invoice amount must be non-negative")});function InvoiceForm(e){var t,a,s;let{invoice:i,onSuccess:l,onCancel:c}=e,[d,o]=(0,n.useState)(!1),[u,p]=(0,n.useState)(0),[h,g]=(0,n.useState)(1),[y,b]=(0,n.useState)(i?i.training_dates.map(e=>{var t,a,r;return{date:e.date,start_time:e.start_time,end_time:e.end_time,room_rent_option_id:null!==(t=e.room_rent_option_id)&&void 0!==t?t:null,lunch_catering_option_id:null!==(a=e.lunch_catering_option_id)&&void 0!==a?a:null,dinner_catering_option_id:null!==(r=e.dinner_catering_option_id)&&void 0!==r?r:null}}):[{date:"",start_time:"09:00",end_time:"17:00",room_rent_option_id:null,lunch_catering_option_id:null,dinner_catering_option_id:null}]),[j,v]=(0,n.useState)("details"),[N,_]=(0,n.useState)(!1),[w,k]=(0,n.useState)(null);console.log("Training Dates:",y);let{register:C,handleSubmit:S,watch:F,setValue:A,control:E,formState:{errors:D}}=(0,m.cI)({resolver:(0,x.F)(f),defaultValues:i?{invoice_number:null!==(a=i.invoice_number)&&void 0!==a?a:"",invoice_date:null!==(s=i.invoice_date)&&void 0!==s?s:"",customer:i.customer,training_name:i.training_name,training_dates:i.training_dates,trainer_costs:i.trainer_costs,office_costs:i.office_costs,margin_percentage:i.margin_percentage,total_invoice_amount:i.total_invoice_amount}:{invoice_number:"",invoice_date:"",customer:"",training_name:"",training_dates:[{date:"",start_time:"09:00",end_time:"17:00",room_rent_option_id:null,lunch_catering_option_id:null,dinner_catering_option_id:null}],trainer_costs:0,office_costs:0,margin_percentage:25,total_invoice_amount:0}});(0,n.useEffect)(()=>{A("training_dates",y)},[y,A]),(0,n.useEffect)(()=>{0===y.length&&b([{date:"",start_time:"09:00",end_time:"17:00",room_rent_option_id:null,lunch_catering_option_id:null,dinner_catering_option_id:null}])},[y]);let I=F(["training_dates","trainer_costs","office_costs","margin_percentage"]);(0,n.useEffect)(()=>{let[e,t,a,r]=I;if(Array.isArray(e)){let t=Array.from(new Set(e.filter(e=>e.date).map(e=>e.date)));g(t.length)}if(void 0!==t&&void 0!==a&&void 0!==r){let e=t+a+t*(r/100);p(e),A("total_invoice_amount",e)}},[I,A]);let onSubmit=async e=>{o(!0);try{let t=i?"/api/training-invoices/".concat(i.id):"/api/training-invoices",a=i?"PUT":"POST",r=await fetch(t,{method:a,headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),n=await r.json();n.success?l(n.data):alert(n.error||"Failed to save invoice")}catch(e){alert("Failed to save invoice")}finally{o(!1)}},handleOpenOptionsModal=e=>{k(e),_(!0)};return(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex border-b mb-4",children:[(0,r.jsx)("button",{className:"px-4 py-2 -mb-px border-b-2 font-medium focus:outline-none ".concat("details"===j?"border-primary-600 text-primary-700":"border-transparent text-gray-500"),onClick:()=>v("details"),children:"Invoice Details"}),(null==i?void 0:i.id)&&(0,r.jsx)("button",{className:"px-4 py-2 -mb-px border-b-2 font-medium focus:outline-none ".concat("participants"===j?"border-primary-600 text-primary-700":"border-transparent text-gray-500"),onClick:()=>v("participants"),children:"Participants"})]}),"details"===j&&(0,r.jsxs)("form",{onSubmit:S(onSubmit),className:"space-y-6",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"invoice_number",className:"block text-sm font-medium text-gray-700",children:"Invoice Number"}),(0,r.jsx)("input",{type:"text",id:"invoice_number",...C("invoice_number"),className:"input-field mt-1 text-black",placeholder:"Enter invoice number (optional)"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"invoice_date",className:"block text-sm font-medium text-gray-700",children:"Invoice Date *"}),(0,r.jsx)("input",{type:"date",id:"invoice_date",...C("invoice_date"),className:"input-field mt-1 text-black"}),D.invoice_date&&(0,r.jsx)("p",{className:"mt-1 text-sm text-red-600",children:D.invoice_date.message})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"customer",className:"block text-sm font-medium text-gray-700",children:"Customer *"}),(0,r.jsx)("input",{type:"text",id:"customer",...C("customer"),className:"input-field mt-1 text-black",placeholder:"Enter customer name"}),D.customer&&(0,r.jsx)("p",{className:"mt-1 text-sm text-red-600",children:D.customer.message})]}),(0,r.jsxs)("div",{className:"md:col-span-2",children:[(0,r.jsx)("label",{htmlFor:"training_name",className:"block text-sm font-medium text-gray-700",children:"Training Name *"}),(0,r.jsx)("input",{type:"text",id:"training_name",...C("training_name"),className:"input-field mt-1 text-black",placeholder:"Enter training name"}),D.training_name&&(0,r.jsx)("p",{className:"mt-1 text-sm text-red-600",children:D.training_name.message})]}),(0,r.jsxs)("div",{className:"md:col-span-2",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Training Dates *"}),(0,r.jsx)("div",{className:"space-y-2",children:y.map((e,t)=>(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("input",{type:"date",value:e.date||"",onChange:e=>{let a=[...y];a[t]={...a[t],date:e.target.value},b(a)},className:"input-field text-black"}),(0,r.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,r.jsx)("label",{className:"text-xs text-gray-500 whitespace-nowrap",children:"Start:"}),(0,r.jsx)("input",{type:"time",value:e.start_time||"",onChange:e=>{let a=[...y];a[t]={...a[t],start_time:e.target.value},b(a)},className:"input-field text-black w-28",step:"900",required:!0,pattern:"[0-9]{2}:[0-9]{2}",inputMode:"numeric",lang:"en"})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,r.jsx)("label",{className:"text-xs text-gray-500 whitespace-nowrap",children:"End:"}),(0,r.jsx)("input",{type:"time",value:e.end_time||"",onChange:e=>{let a=[...y];a[t]={...a[t],end_time:e.target.value},b(a)},className:"input-field text-black w-28",step:"900",required:!0,pattern:"[0-9]{2}:[0-9]{2}",inputMode:"numeric",lang:"en"})]}),(0,r.jsx)("button",{type:"button",onClick:()=>handleOpenOptionsModal(t),className:"btn-secondary text-sm px-3 py-1",children:"Configure Options"}),(0,r.jsx)("button",{type:"button",onClick:()=>b(y.filter((e,a)=>a!==t)),className:"btn-secondary px-2 py-1",disabled:1===y.length,title:"Remove date",children:"–"})]},t))}),(0,r.jsx)("div",{className:"mt-2",children:(0,r.jsx)("button",{type:"button",onClick:()=>b([...y,{date:"",start_time:"09:00",end_time:"17:00",room_rent_option_id:null,lunch_catering_option_id:null,dinner_catering_option_id:null}]),className:"btn-primary text-sm px-3 py-1",title:"Add training date",children:"+ Add Training Date"})}),D.training_dates&&(0,r.jsx)("p",{className:"mt-1 text-sm text-red-600",children:Array.isArray(D.training_dates)?D.training_dates.map((e,t)=>(null==e?void 0:e.message)&&(0,r.jsxs)("span",{children:[e.message,(0,r.jsx)("br",{})]},t)):null===(t=D.training_dates)||void 0===t?void 0:t.message})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Duration (Days)"}),(0,r.jsx)("input",{type:"number",value:h,readOnly:!0,className:"input-field mt-1 bg-gray-50 text-black"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"margin_percentage",className:"block text-sm font-medium text-gray-700",children:"Margin Percentage (%) *"}),(0,r.jsx)("input",{type:"number",id:"margin_percentage",...C("margin_percentage",{valueAsNumber:!0}),className:"input-field mt-1 text-black",min:"0",step:"0.01",placeholder:"25"}),D.margin_percentage&&(0,r.jsx)("p",{className:"mt-1 text-sm text-red-600",children:D.margin_percentage.message})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"trainer_costs",className:"block text-sm font-medium text-gray-700",children:"Trainer Costs (€) *"}),(0,r.jsx)("input",{type:"number",id:"trainer_costs",...C("trainer_costs",{valueAsNumber:!0}),className:"input-field mt-1 text-black",min:"0",step:"0.01",placeholder:"0.00"}),D.trainer_costs&&(0,r.jsx)("p",{className:"mt-1 text-sm text-red-600",children:D.trainer_costs.message})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"office_costs",className:"block text-sm font-medium text-gray-700",children:"Office Costs (€) *"}),(0,r.jsx)("input",{type:"number",id:"office_costs",...C("office_costs",{valueAsNumber:!0}),className:"input-field mt-1 text-black",min:"0",step:"0.01",placeholder:"0.00"}),D.office_costs&&(0,r.jsx)("p",{className:"mt-1 text-sm text-red-600",children:D.office_costs.message})]}),(0,r.jsxs)("div",{className:"md:col-span-2",children:[(0,r.jsx)("label",{htmlFor:"total_invoice_amount",className:"block text-sm font-medium text-gray-700",children:"Total Invoice Amount (€) *"}),(0,r.jsx)("input",{type:"number",id:"total_invoice_amount",...C("total_invoice_amount",{valueAsNumber:!0}),className:"input-field mt-1 bg-gray-50 text-black",min:"0",step:"0.01",placeholder:"0.00",readOnly:!0}),(0,r.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"Calculated automatically based on costs and margin"}),D.total_invoice_amount&&(0,r.jsx)("p",{className:"mt-1 text-sm text-red-600",children:D.total_invoice_amount.message})]})]}),(0,r.jsxs)("div",{className:"flex justify-end space-x-3 pt-6 border-t",children:[(0,r.jsx)("button",{type:"button",onClick:c,className:"btn-secondary",disabled:d,children:"Cancel"}),(0,r.jsx)("button",{type:"submit",className:"btn-primary",disabled:d,children:d?"Saving...":i?"Update Invoice":"Create Invoice"})]})]}),"participants"===j&&(null==i?void 0:i.id)&&(0,r.jsx)(ParticipantsTable,{trainingInvoiceId:i.id}),N&&null!==w&&(0,r.jsx)(TrainingDayOptionsModal,{isOpen:N,onClose:()=>_(!1),trainingDay:y[w],onSave:e=>{if(null!==w){let t=[...y];t[w]={...t[w],...e},b(t)}}})]})}function InvoiceList(e){let{invoices:t,onUpdate:a,onDelete:m}=e,[x,u]=(0,n.useState)(null),[p,h]=(0,n.useState)(null),handleEdit=e=>{u(e)},handleDelete=async e=>{if(confirm("Are you sure you want to delete this training invoice?"))try{h(e);let t=await fetch("/api/training-invoices/".concat(e),{method:"DELETE"});if(t.ok)m(e);else{let e=await t.json();alert(e.error||"Failed to delete invoice")}}catch(e){alert("Failed to delete invoice")}finally{h(null)}};return 0===t.length?(0,r.jsx)("div",{className:"card",children:(0,r.jsxs)("div",{className:"text-center py-12",children:[(0,r.jsx)(i.Z,{className:"mx-auto h-12 w-12 text-gray-400"}),(0,r.jsx)("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No training invoices"}),(0,r.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"Get started by creating your first training invoice."})]})}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"card overflow-hidden",children:(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,r.jsx)("thead",{className:"bg-gray-50",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-24",children:"Invoice #"}),(0,r.jsx)("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-24",children:"Date"}),(0,r.jsx)("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider min-w-0 flex-1",children:"Training"}),(0,r.jsx)("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-20",children:"Days"}),(0,r.jsx)("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-32",children:"Costs"}),(0,r.jsx)("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-16",children:"Margin"}),(0,r.jsx)("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-28",children:"Total"}),(0,r.jsx)("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider min-w-0 flex-1",children:"Customer"}),(0,r.jsx)("th",{className:"px-3 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider w-20",children:"Actions"})]})}),(0,r.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:t.map(e=>(0,r.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,r.jsx)("td",{className:"px-3 py-4 whitespace-nowrap",children:(0,r.jsx)("div",{className:"text-sm text-gray-900",children:e.invoice_number||(0,r.jsx)("span",{className:"text-gray-400 italic",children:"-"})})}),(0,r.jsx)("td",{className:"px-3 py-4 whitespace-nowrap",children:(0,r.jsx)("div",{className:"text-sm text-gray-900",children:e.invoice_date?(0,s.Z)(new Date(e.invoice_date),"dd-MM-yyyy"):"-"})}),(0,r.jsx)("td",{className:"px-3 py-4",children:(0,r.jsx)("div",{className:"text-sm font-medium text-gray-900 truncate",children:e.training_name})}),(0,r.jsx)("td",{className:"px-3 py-4 whitespace-nowrap",children:(0,r.jsxs)("div",{className:"flex items-center text-sm text-gray-900",children:[(0,r.jsx)(l.Z,{className:"h-4 w-4 mr-1 text-gray-400"}),e.duration_days]})}),(0,r.jsx)("td",{className:"px-3 py-4 whitespace-nowrap",children:(0,r.jsxs)("div",{className:"text-sm text-gray-900",children:[(0,r.jsxs)("div",{children:["€",e.trainer_costs.toLocaleString("nl-NL",{minimumFractionDigits:0})]}),(0,r.jsxs)("div",{children:["€",e.office_costs.toLocaleString("nl-NL",{minimumFractionDigits:0})]})]})}),(0,r.jsx)("td",{className:"px-3 py-4 whitespace-nowrap",children:(0,r.jsxs)("div",{className:"text-sm text-gray-900",children:[e.margin_percentage,"%"]})}),(0,r.jsx)("td",{className:"px-3 py-4 whitespace-nowrap",children:(0,r.jsxs)("div",{className:"flex items-center text-sm font-medium text-gray-900",children:[(0,r.jsx)(c.Z,{className:"h-4 w-4 mr-1 text-green-600"}),"€",e.total_invoice_amount.toLocaleString("nl-NL",{minimumFractionDigits:0})]})}),(0,r.jsx)("td",{className:"px-3 py-4",children:(0,r.jsx)("div",{className:"text-sm text-gray-900 truncate",children:e.customer})}),(0,r.jsx)("td",{className:"px-3 py-4 whitespace-nowrap text-right text-sm font-medium",children:(0,r.jsxs)("div",{className:"flex items-center justify-end space-x-1",children:[(0,r.jsx)("button",{onClick:()=>handleEdit(e),className:"text-primary-600 hover:text-primary-900 p-1",title:"Edit",children:(0,r.jsx)(d.Z,{className:"h-4 w-4"})}),(0,r.jsx)("button",{onClick:()=>handleDelete(e.id),disabled:p===e.id,className:"text-red-600 hover:text-red-900 p-1 disabled:opacity-50",title:"Delete",children:(0,r.jsx)(o.Z,{className:"h-4 w-4"})})]})})]},e.id))})]})})}),x&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-[705px] mx-4 max-h-[90vh] overflow-y-auto",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold",children:"Edit Training Invoice"}),(0,r.jsx)("button",{onClick:()=>u(null),className:"text-gray-400 hover:text-gray-600",children:"✕"})]}),(0,r.jsx)(InvoiceForm,{invoice:x,onSuccess:e=>{a(e),u(null)},onCancel:()=>u(null)})]})})]})}var b=a(6637),j=a(9155),v=a(6357);function AdminTasksTable(e){let{invoices:t,onUpdate:a}=e,[l,c]=(0,n.useState)(null),handleCheckboxChange=async(e,t,r)=>{c(e);try{let n=await fetch("/api/training-invoices/".concat(e),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({[t]:r})});if(n.ok){let e=await n.json();e.success&&a(e.data)}}catch(e){console.error("Failed to update task:",e)}finally{c(null)}},getFirstTrainingDate=e=>{if(!e||0===e.length)return"-";let t=e[0];return t.date?(0,s.Z)(new Date(t.date),"dd-MM-yyyy"):"-"};return 0===t.length?(0,r.jsx)("div",{className:"card",children:(0,r.jsxs)("div",{className:"text-center py-12",children:[(0,r.jsx)(b.Z,{className:"mx-auto h-12 w-12 text-gray-400"}),(0,r.jsx)("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No training invoices"}),(0,r.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"Create your first training invoice to see administrative tasks."})]})}):(0,r.jsx)("div",{className:"card overflow-hidden",children:(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,r.jsx)("thead",{className:"bg-gray-50",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider min-w-0 flex-1",children:"Training"}),(0,r.jsx)("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-24",children:"Date"}),(0,r.jsx)("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-20",title:"Trainer gemaild voor beschikbaarheid?",children:"Trainer Available"}),(0,r.jsx)("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-20",title:"Toegevoegd masterclass planning?",children:"Masterclass Planning"}),(0,r.jsx)("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-16",title:"Staat in aNS",children:"In LMS"}),(0,r.jsx)("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-20",title:"Trainer uitgenodigd agenda?",children:"Trainer Invited"}),(0,r.jsx)("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-20",title:"Kan verzamelfactuur verzonden worden door admin?",children:"Invoice Ready"}),(0,r.jsx)("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-20",title:"Verzamelfactuur verstuurd door admin naar Navara?",children:"Send to NAVARA"})]})}),(0,r.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:t.map(e=>(0,r.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,r.jsxs)("td",{className:"px-3 py-4",children:[(0,r.jsx)("div",{className:"text-sm font-medium text-gray-900 truncate",children:e.training_name}),(0,r.jsx)("div",{className:"text-sm text-gray-500 truncate",children:e.customer})]}),(0,r.jsx)("td",{className:"px-3 py-4 whitespace-nowrap",children:(0,r.jsxs)("div",{className:"flex items-center text-sm text-gray-900",children:[(0,r.jsx)(i.Z,{className:"h-4 w-4 mr-1 text-gray-400"}),getFirstTrainingDate(e.training_dates)]})}),(0,r.jsx)("td",{className:"px-3 py-4 whitespace-nowrap",children:(0,r.jsx)("button",{onClick:()=>handleCheckboxChange(e.id,"trainer_availability_emailed",!e.trainer_availability_emailed),disabled:l===e.id,className:"flex items-center justify-center text-sm text-gray-900 hover:text-primary-600 disabled:opacity-50",children:e.trainer_availability_emailed?(0,r.jsx)(j.Z,{className:"h-5 w-5 text-green-600"}):(0,r.jsx)(v.Z,{className:"h-5 w-5 text-gray-400"})})}),(0,r.jsx)("td",{className:"px-3 py-4 whitespace-nowrap",children:(0,r.jsx)("button",{onClick:()=>handleCheckboxChange(e.id,"masterclass_planning_added",!e.masterclass_planning_added),disabled:l===e.id,className:"flex items-center justify-center text-sm text-gray-900 hover:text-primary-600 disabled:opacity-50",children:e.masterclass_planning_added?(0,r.jsx)(j.Z,{className:"h-5 w-5 text-green-600"}):(0,r.jsx)(v.Z,{className:"h-5 w-5 text-gray-400"})})}),(0,r.jsx)("td",{className:"px-3 py-4 whitespace-nowrap",children:(0,r.jsx)("button",{onClick:()=>handleCheckboxChange(e.id,"lms_updated",!e.lms_updated),disabled:l===e.id,className:"flex items-center justify-center text-sm text-gray-900 hover:text-primary-600 disabled:opacity-50",children:e.lms_updated?(0,r.jsx)(j.Z,{className:"h-5 w-5 text-green-600"}):(0,r.jsx)(v.Z,{className:"h-5 w-5 text-gray-400"})})}),(0,r.jsx)("td",{className:"px-3 py-4 whitespace-nowrap",children:(0,r.jsx)("button",{onClick:()=>handleCheckboxChange(e.id,"navara_event_agenda_updated",!e.navara_event_agenda_updated),disabled:l===e.id,className:"flex items-center justify-center text-sm text-gray-900 hover:text-primary-600 disabled:opacity-50",children:e.navara_event_agenda_updated?(0,r.jsx)(j.Z,{className:"h-5 w-5 text-green-600"}):(0,r.jsx)(v.Z,{className:"h-5 w-5 text-gray-400"})})}),(0,r.jsx)("td",{className:"px-3 py-4 whitespace-nowrap",children:(0,r.jsx)("button",{onClick:()=>handleCheckboxChange(e.id,"catering_ordered",!e.catering_ordered),disabled:l===e.id,className:"flex items-center justify-center text-sm text-gray-900 hover:text-primary-600 disabled:opacity-50",children:e.catering_ordered?(0,r.jsx)(j.Z,{className:"h-5 w-5 text-green-600"}):(0,r.jsx)(v.Z,{className:"h-5 w-5 text-gray-400"})})}),(0,r.jsx)("td",{className:"px-3 py-4 whitespace-nowrap",children:(0,r.jsx)("button",{onClick:()=>handleCheckboxChange(e.id,"trainer_invoice_received",!e.trainer_invoice_received),disabled:l===e.id,className:"flex items-center justify-center text-sm text-gray-900 hover:text-primary-600 disabled:opacity-50",children:e.trainer_invoice_received?(0,r.jsx)(j.Z,{className:"h-5 w-5 text-green-600"}):(0,r.jsx)(v.Z,{className:"h-5 w-5 text-gray-400"})})})]},e.id))})]})})})}var N=a(1827),_=a(2482),w=a(3523);function MultiSelect(e){let{options:t,value:a,onChange:s,placeholder:i="Select options...",label:l}=e,[c,d]=(0,n.useState)(!1),o=(0,n.useRef)(null);(0,n.useEffect)(()=>{let handleClickOutside=e=>{o.current&&!o.current.contains(e.target)&&d(!1)};return document.addEventListener("mousedown",handleClickOutside),()=>document.removeEventListener("mousedown",handleClickOutside)},[]);let handleToggle=e=>{if("string"==typeof e){let t=a.includes(e)?a.filter(t=>t!==e):[...a,e];s(t)}else{let t=a.includes(e)?a.filter(t=>t!==e):[...a,e];s(t)}},removeItem=e=>{"string"==typeof e?s(a.filter(t=>t!==e)):s(a.filter(t=>t!==e))},getDisplayValue=e=>{if("string"==typeof e){let a=t.find(t=>t.value===e);return a?a.label:e}return e.toString()},m=a.map(e=>getDisplayValue(e)),checkIsSelected=e=>a.includes(e);return(0,r.jsxs)("div",{className:"relative",ref:o,children:[l&&(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:l}),(0,r.jsx)("div",{className:"min-h-[42px] border border-gray-300 rounded-lg bg-white cursor-pointer hover:border-gray-400 focus-within:ring-2 focus-within:ring-primary-500 focus-within:border-transparent",onClick:()=>d(!c),children:(0,r.jsxs)("div",{className:"flex items-center justify-between p-2",children:[(0,r.jsx)("div",{className:"flex flex-wrap gap-1 flex-1 min-w-0",children:m.length>0?m.map((e,t)=>(0,r.jsxs)("span",{className:"inline-flex items-center px-2 py-1 rounded-md text-xs font-medium bg-blue-100 text-blue-800 border border-blue-200",children:[e,(0,r.jsx)("button",{type:"button",onClick:e=>{e.stopPropagation(),removeItem(a[t])},className:"ml-1 inline-flex items-center justify-center w-4 h-4 rounded-full text-blue-500 hover:bg-blue-200 hover:text-blue-700 transition-colors",children:(0,r.jsx)(p.Z,{className:"w-3 h-3"})})]},t)):(0,r.jsx)("span",{className:"text-gray-500",children:i})}),(0,r.jsx)(w.Z,{className:"h-4 w-4 text-gray-400 transition-transform ".concat(c?"rotate-180":"")})]})}),c&&(0,r.jsx)("div",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-60 overflow-y-auto",children:t.length>0?t.map((e,t)=>{let a="object"==typeof e?e.value:e,n="object"==typeof e?e.label:e.toString(),s=checkIsSelected(a);return(0,r.jsx)("div",{className:"px-3 py-2 cursor-pointer hover:bg-gray-50 transition-colors ".concat(s?"bg-blue-50 text-gray-900":"text-gray-900"),onClick:()=>handleToggle(a),children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"w-4 h-4 border rounded mr-2 flex items-center justify-center ".concat(s?"bg-blue-600 border-blue-600":"border-gray-300"),children:s&&(0,r.jsx)("svg",{className:"w-3 h-3 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})}),n]})},t)}):(0,r.jsx)("div",{className:"px-3 py-2 text-gray-500",children:"No options available"})})]})}function InvoiceFilters(e){let t,{onFilterChange:a,customers:s,months:i,years:l}=e,[c,d]=(0,n.useState)({search:"",customer:"",months:[],years:[],minAmount:"",maxAmount:""}),[o,m]=(0,n.useState)(!1),handleFilterChange=(e,t)=>{let r={...c,[e]:t};d(r),a(r)},x=""!==c.search||""!==c.customer||c.months.length>0||c.years.length>0||""!==c.minAmount||""!==c.maxAmount;return(0,r.jsxs)("div",{className:"card mb-4",children:[(0,r.jsx)("div",{className:"flex items-center justify-between mb-4",children:(0,r.jsxs)("div",{className:"flex items-center space-x-4 flex-1",children:[(0,r.jsxs)("div",{className:"relative flex-1 max-w-md",children:[(0,r.jsx)(N.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),(0,r.jsx)("input",{type:"text",placeholder:"Search training name, invoice number...",value:c.search,onChange:e=>handleFilterChange("search",e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent text-gray-900 bg-white"})]}),(0,r.jsxs)("button",{onClick:()=>m(!o),className:"flex items-center px-3 py-2 rounded-lg border ".concat(o||x?"bg-primary-50 border-primary-200 text-primary-700":"bg-white border-gray-300 text-gray-700 hover:bg-gray-50"),children:[(0,r.jsx)(_.Z,{className:"h-4 w-4 mr-2"}),"Filters",x&&(0,r.jsx)("span",{className:"ml-2 bg-primary-600 text-white text-xs rounded-full px-2 py-1",children:(t=0,""!==c.search&&t++,""!==c.customer&&t++,c.months.length>0&&t++,c.years.length>0&&t++,""!==c.minAmount&&t++,""!==c.maxAmount&&t++,t)})]}),x&&(0,r.jsxs)("button",{onClick:()=>{let e={search:"",customer:"",months:[],years:[],minAmount:"",maxAmount:""};d(e),a(e)},className:"flex items-center px-3 py-2 text-gray-600 hover:text-gray-800",children:[(0,r.jsx)(p.Z,{className:"h-4 w-4 mr-1"}),"Clear"]})]})}),o&&(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 pt-4 border-t border-gray-200",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Customer"}),(0,r.jsxs)("select",{value:c.customer,onChange:e=>handleFilterChange("customer",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent text-gray-900 bg-white",children:[(0,r.jsx)("option",{value:"",children:"All customers"}),s.map(e=>(0,r.jsx)("option",{value:e,children:e},e))]})]}),(0,r.jsx)("div",{children:(0,r.jsx)(MultiSelect,{options:i,value:c.months,onChange:e=>handleFilterChange("months",e),placeholder:"Select months...",label:"Months"})}),(0,r.jsx)("div",{children:(0,r.jsx)(MultiSelect,{options:l,value:c.years,onChange:e=>handleFilterChange("years",e),placeholder:"Select years...",label:"Years"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Min Amount (€)"}),(0,r.jsx)("input",{type:"number",placeholder:"0",value:c.minAmount,onChange:e=>handleFilterChange("minAmount",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent text-gray-900 bg-white"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Max Amount (€)"}),(0,r.jsx)("input",{type:"number",placeholder:"∞",value:c.maxAmount,onChange:e=>handleFilterChange("maxAmount",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent text-gray-900 bg-white"})]})]})]})}function AdminFilters(e){let t,{onFilterChange:a,customers:s,months:i,years:l}=e,[c,d]=(0,n.useState)({search:"",customer:"",months:[],years:[],taskStatus:""}),[o,m]=(0,n.useState)(!1),handleFilterChange=(e,t)=>{let r={...c,[e]:t};d(r),a(r)},x=""!==c.search||""!==c.customer||c.months.length>0||c.years.length>0||""!==c.taskStatus;return(0,r.jsxs)("div",{className:"card mb-4",children:[(0,r.jsx)("div",{className:"flex items-center justify-between mb-4",children:(0,r.jsxs)("div",{className:"flex items-center space-x-4 flex-1",children:[(0,r.jsxs)("div",{className:"relative flex-1 max-w-md",children:[(0,r.jsx)(N.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),(0,r.jsx)("input",{type:"text",placeholder:"Search training name...",value:c.search,onChange:e=>handleFilterChange("search",e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent text-gray-900 bg-white"})]}),(0,r.jsxs)("button",{onClick:()=>m(!o),className:"flex items-center px-3 py-2 rounded-lg border ".concat(o||x?"bg-primary-50 border-primary-200 text-primary-700":"bg-white border-gray-300 text-gray-700 hover:bg-gray-50"),children:[(0,r.jsx)(_.Z,{className:"h-4 w-4 mr-2"}),"Filters",x&&(0,r.jsx)("span",{className:"ml-2 bg-primary-600 text-white text-xs rounded-full px-2 py-1",children:(t=0,""!==c.search&&t++,""!==c.customer&&t++,c.months.length>0&&t++,c.years.length>0&&t++,""!==c.taskStatus&&t++,t)})]}),x&&(0,r.jsxs)("button",{onClick:()=>{let e={search:"",customer:"",months:[],years:[],taskStatus:""};d(e),a(e)},className:"flex items-center px-3 py-2 text-gray-600 hover:text-gray-800",children:[(0,r.jsx)(p.Z,{className:"h-4 w-4 mr-1"}),"Clear"]})]})}),o&&(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 pt-4 border-t border-gray-200",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Customer"}),(0,r.jsxs)("select",{value:c.customer,onChange:e=>handleFilterChange("customer",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent text-gray-900 bg-white",children:[(0,r.jsx)("option",{value:"",children:"All customers"}),s.map(e=>(0,r.jsx)("option",{value:e,children:e},e))]})]}),(0,r.jsx)("div",{children:(0,r.jsx)(MultiSelect,{options:i,value:c.months,onChange:e=>handleFilterChange("months",e),placeholder:"Select months...",label:"Months"})}),(0,r.jsx)("div",{children:(0,r.jsx)(MultiSelect,{options:l,value:c.years,onChange:e=>handleFilterChange("years",e),placeholder:"Select years...",label:"Years"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Task Status"}),(0,r.jsxs)("select",{value:c.taskStatus,onChange:e=>handleFilterChange("taskStatus",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent text-gray-900 bg-white",children:[(0,r.jsx)("option",{value:"",children:"All tasks"}),(0,r.jsx)("option",{value:"completed",children:"Completed tasks"}),(0,r.jsx)("option",{value:"pending",children:"Pending tasks"})]})]})]})]})}function filterInvoices(e,t){return e.filter(e=>{if(t.search){let a=t.search.toLowerCase(),r=e.training_name.toLowerCase().includes(a)||e.invoice_number&&e.invoice_number.toLowerCase().includes(a)||e.customer.toLowerCase().includes(a);if(!r)return!1}if(t.customer&&e.customer!==t.customer)return!1;if(t.months&&t.months.length>0){let a=e.invoice_date?new Date(e.invoice_date):null;if(!a)return!1;let r="".concat(a.getFullYear(),"-").concat(String(a.getMonth()+1).padStart(2,"0"));if(!t.months.includes(r))return!1}if(t.years&&t.years.length>0){let a=e.invoice_date?new Date(e.invoice_date):null;if(!a||!t.years.includes(a.getFullYear()))return!1}if(t.minAmount){let a=parseFloat(t.minAmount);if(e.total_invoice_amount<a)return!1}if(t.maxAmount){let a=parseFloat(t.maxAmount);if(e.total_invoice_amount>a)return!1}return!0})}function filterAdminTasks(e,t){return e.filter(e=>{var a,r,n,s;if(t.search){let a=t.search.toLowerCase(),r=e.training_name.toLowerCase().includes(a)||e.customer.toLowerCase().includes(a);if(!r)return!1}if(t.customer&&e.customer!==t.customer)return!1;if(t.months&&t.months.length>0){let n=(null===(r=e.training_dates)||void 0===r?void 0:null===(a=r[0])||void 0===a?void 0:a.date)?new Date(e.training_dates[0].date):null;if(!n)return!1;let s="".concat(n.getFullYear(),"-").concat(String(n.getMonth()+1).padStart(2,"0"));if(!t.months.includes(s))return!1}if(t.years&&t.years.length>0){let a=(null===(s=e.training_dates)||void 0===s?void 0:null===(n=s[0])||void 0===n?void 0:n.date)?new Date(e.training_dates[0].date):null;if(!a||!t.years.includes(a.getFullYear()))return!1}if(t.taskStatus){let a=[e.trainer_availability_emailed,e.masterclass_planning_added,e.lms_updated,e.navara_event_agenda_updated,e.catering_ordered,e.trainer_invoice_received],r=a.filter(e=>e).length,n=a.length;if("completed"===t.taskStatus&&r<n||"pending"===t.taskStatus&&r===n)return!1}return!0})}function getUniqueCustomers(e){let t=e.map(e=>e.customer);return Array.from(new Set(t)).sort()}function getAvailableMonths(e){let t=new Set;return e.forEach(e=>{if(e.invoice_date){let a=new Date(e.invoice_date),r="".concat(a.getFullYear(),"-").concat(String(a.getMonth()+1).padStart(2,"0"));t.add(r)}e.training_dates&&e.training_dates.length>0&&e.training_dates.forEach(e=>{if(e.date){let a=new Date(e.date),r="".concat(a.getFullYear(),"-").concat(String(a.getMonth()+1).padStart(2,"0"));t.add(r)}})}),Array.from(t).sort().map(e=>{let[t,a]=e.split("-"),r=new Date(parseInt(t),parseInt(a)-1);return{value:e,label:r.toLocaleDateString("en-US",{year:"numeric",month:"long"})}})}function getAvailableYears(e){let t=new Set;return e.forEach(e=>{if(e.invoice_date){let a=new Date(e.invoice_date);t.add(a.getFullYear())}e.training_dates&&e.training_dates.length>0&&e.training_dates.forEach(e=>{if(e.date){let a=new Date(e.date);t.add(a.getFullYear())}})}),Array.from(t).sort((e,t)=>t-e)}var k=a(7972),C=a(5883),S=a(9883),F=a(3549);function UserManagement(e){let{onClose:t}=e,[a,s]=(0,n.useState)([]),[i,l]=(0,n.useState)(!0),[c,m]=(0,n.useState)(!1),[x,u]=(0,n.useState)(!1),[p,h]=(0,n.useState)(null),[g,y]=(0,n.useState)(""),[f,b]=(0,n.useState)({username:"",email:"",password:"",role:"user",name:""}),[j,v]=(0,n.useState)({username:"",email:"",role:"user",name:""}),fetchUsers=async()=>{try{l(!0);let e=await fetch("/api/users"),t=await e.json();t.success?s(t.data):y(t.error||"Failed to fetch users")}catch(e){y("Failed to fetch users")}finally{l(!1)}};(0,n.useEffect)(()=>{fetchUsers()},[]);let handleCreateUser=async e=>{e.preventDefault(),y("");try{let e=await fetch("/api/users",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(f)}),t=await e.json();t.success?(s([...a,t.data]),m(!1),b({username:"",email:"",password:"",role:"user",name:""})):y(t.error||"Failed to create user")}catch(e){y("An error occurred while creating user")}},handleInputChange=e=>{let{name:t,value:a}=e.target;b(e=>({...e,[t]:a}))},handleEditInputChange=e=>{let{name:t,value:a}=e.target;v(e=>({...e,[t]:a}))},handleEditUser=e=>{h(e),v({username:e.username,email:e.email,role:e.role,name:e.name}),u(!0)},handleUpdateUser=async e=>{if(e.preventDefault(),p){y("");try{let e=await fetch("/api/users/".concat(p.id),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(j)}),t=await e.json();t.success?(s(a.map(e=>e.id===p.id?t.data:e)),u(!1),h(null),v({username:"",email:"",role:"user",name:""})):y(t.error||"Failed to update user")}catch(e){y("An error occurred while updating user")}}},handleDeleteUser=async e=>{if(confirm("Are you sure you want to delete this user?")){y("");try{let t=await fetch("/api/users/".concat(e),{method:"DELETE"}),r=await t.json();r.success?s(a.filter(t=>t.id!==e)):y(r.error||"Failed to delete user")}catch(e){y("An error occurred while deleting user")}}};return(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-4xl mx-4 max-h-[90vh] overflow-y-auto",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold",children:"User Management"}),(0,r.jsx)("button",{onClick:t,className:"text-gray-400 hover:text-gray-600",children:"✕"})]}),g&&(0,r.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-4",children:(0,r.jsx)("p",{className:"text-red-800",children:g})}),(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,r.jsxs)("h4",{className:"text-md font-medium",children:["Users (",a.length,")"]}),(0,r.jsxs)("button",{onClick:()=>m(!0),className:"btn-primary flex items-center",children:[(0,r.jsx)(S.Z,{className:"h-4 w-4 mr-2"}),"Add User"]})]}),i?(0,r.jsxs)("div",{className:"flex items-center justify-center py-8",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"}),(0,r.jsx)("span",{className:"ml-2 text-gray-600",children:"Loading users..."})]}):(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,r.jsx)("thead",{className:"bg-gray-50",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Username"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Email"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Role"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Created"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,r.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:a.map(e=>(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:e.name}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.username}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.email}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full ".concat("admin"===e.role?"bg-red-100 text-red-800":"manager"===e.role?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"),children:e.role})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.created_at?new Date(e.created_at).toLocaleDateString():"-"}),(0,r.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:[(0,r.jsx)("button",{onClick:()=>handleEditUser(e),className:"text-primary-600 hover:text-primary-900 mr-3",title:"Edit user",children:(0,r.jsx)(d.Z,{className:"h-4 w-4"})}),(0,r.jsx)("button",{onClick:()=>e.id&&handleDeleteUser(e.id),className:"".concat(1===e.id?"text-gray-400 cursor-not-allowed":"text-red-600 hover:text-red-900"),title:1===e.id?"Cannot delete default admin user":"Delete user",disabled:1===e.id,children:(0,r.jsx)(o.Z,{className:"h-4 w-4"})})]})]},e.id))})]})}),c&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold",children:"Create New User"}),(0,r.jsx)("button",{onClick:()=>m(!1),className:"text-gray-400 hover:text-gray-600",children:"✕"})]}),(0,r.jsxs)("form",{onSubmit:handleCreateUser,className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Name"}),(0,r.jsx)("input",{type:"text",name:"name",required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-primary-500 focus:border-primary-500",value:f.name,onChange:handleInputChange})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Username"}),(0,r.jsx)("input",{type:"text",name:"username",required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-primary-500 focus:border-primary-500",value:f.username,onChange:handleInputChange})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Email"}),(0,r.jsx)("input",{type:"email",name:"email",required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-primary-500 focus:border-primary-500",value:f.email,onChange:handleInputChange})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Password"}),(0,r.jsx)("input",{type:"password",name:"password",required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-primary-500 focus:border-primary-500",value:f.password,onChange:handleInputChange})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Role"}),(0,r.jsxs)("select",{name:"role",required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-primary-500 focus:border-primary-500",value:f.role,onChange:handleInputChange,children:[(0,r.jsx)("option",{value:"user",children:"User"}),(0,r.jsx)("option",{value:"manager",children:"Manager"}),(0,r.jsx)("option",{value:"admin",children:"Admin"})]})]}),(0,r.jsxs)("div",{className:"flex justify-end space-x-3 pt-4",children:[(0,r.jsx)("button",{type:"button",onClick:()=>m(!1),className:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50",children:"Cancel"}),(0,r.jsx)("button",{type:"submit",className:"btn-primary",children:"Create User"})]})]})]})}),x&&p&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold",children:"Edit User"}),(0,r.jsx)("button",{onClick:()=>{u(!1),h(null)},className:"text-gray-400 hover:text-gray-600",children:"✕"})]}),(0,r.jsxs)("form",{onSubmit:handleUpdateUser,className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Name"}),(0,r.jsx)("input",{type:"text",name:"name",required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-primary-500 focus:border-primary-500",value:j.name,onChange:handleEditInputChange})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Username"}),(0,r.jsx)("input",{type:"text",name:"username",required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-primary-500 focus:border-primary-500",value:j.username,onChange:handleEditInputChange})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Email"}),(0,r.jsx)("input",{type:"email",name:"email",required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-primary-500 focus:border-primary-500",value:j.email,onChange:handleEditInputChange})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Role"}),(0,r.jsxs)("select",{name:"role",required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-primary-500 focus:border-primary-500",value:j.role,onChange:handleEditInputChange,children:[(0,r.jsx)("option",{value:"user",children:"User"}),(0,r.jsx)("option",{value:"manager",children:"Manager"}),(0,r.jsx)("option",{value:"admin",children:"Admin"})]})]}),(0,r.jsxs)("div",{className:"flex justify-end space-x-3 pt-4",children:[(0,r.jsx)("button",{type:"button",onClick:()=>{u(!1),h(null)},className:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50",children:"Cancel"}),(0,r.jsx)("button",{type:"submit",className:"btn-primary",children:"Update User"})]})]})]})})]})})}function OfficeManagement(e){let{onClose:t}=e,[a,s]=(0,n.useState)("catering"),[i,l]=(0,n.useState)([]),[c,m]=(0,n.useState)(!0),[x,u]=(0,n.useState)(!1),[p,h]=(0,n.useState)(!1),[g,y]=(0,n.useState)(null),[f,b]=(0,n.useState)(""),[j,v]=(0,n.useState)({name:"",description:"",lunch_price_per_participant:"",dinner_price_per_participant:"",is_active:!0}),[N,_]=(0,n.useState)({name:"",description:"",lunch_price_per_participant:"",dinner_price_per_participant:"",is_active:!0}),[w,k]=(0,n.useState)([]),[C,F]=(0,n.useState)(!0),[A,E]=(0,n.useState)(!1),[D,I]=(0,n.useState)(!1),[O,T]=(0,n.useState)(null),[Z,R]=(0,n.useState)(""),[U,L]=(0,n.useState)({name:"",description:"",rent_per_hour:"",is_active:!0}),[P,M]=(0,n.useState)({name:"",description:"",rent_per_hour:"",is_active:!0}),fetchCateringOptions=async()=>{try{m(!0);let e=await fetch("/api/catering-options"),t=await e.json();t.success?l(t.data):b(t.error||"Failed to fetch catering options")}catch(e){b("Failed to fetch catering options")}finally{m(!1)}};(0,n.useEffect)(()=>{fetchCateringOptions()},[]);let fetchRentOptions=async()=>{try{F(!0);let e=await fetch("/api/training-room-rent-options"),t=await e.json();t.success?k(t.data):R(t.error||"Failed to fetch rent options")}catch(e){R("Failed to fetch rent options")}finally{F(!1)}};(0,n.useEffect)(()=>{fetchRentOptions()},[]);let handleCreateOption=async e=>{e.preventDefault(),b("");try{let e=await fetch("/api/catering-options",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...j,lunch_price_per_participant:Number(j.lunch_price_per_participant),dinner_price_per_participant:Number(j.dinner_price_per_participant)})}),t=await e.json();t.success?(l([...i,t.data]),u(!1),v({name:"",description:"",lunch_price_per_participant:"",dinner_price_per_participant:"",is_active:!0})):b(t.error||"Failed to create catering option")}catch(e){b("An error occurred while creating catering option")}},handleEditOption=e=>{var t;y(e),_({name:e.name,description:e.description||"",lunch_price_per_participant:e.lunch_price_per_participant.toString(),dinner_price_per_participant:e.dinner_price_per_participant.toString(),is_active:null===(t=e.is_active)||void 0===t||t}),h(!0)},handleUpdateOption=async e=>{if(e.preventDefault(),g){b("");try{let e=await fetch("/api/catering-options/".concat(g.id),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({...N,lunch_price_per_participant:Number(N.lunch_price_per_participant),dinner_price_per_participant:Number(N.dinner_price_per_participant)})}),t=await e.json();t.success?(l(i.map(e=>e.id===g.id?t.data:e)),h(!1),y(null),_({name:"",description:"",lunch_price_per_participant:"",dinner_price_per_participant:"",is_active:!0})):b(t.error||"Failed to update catering option")}catch(e){b("An error occurred while updating catering option")}}},handleDeleteOption=async e=>{if(confirm("Are you sure you want to delete this catering option?")){b("");try{let t=await fetch("/api/catering-options/".concat(e),{method:"DELETE"}),a=await t.json();a.success?l(i.filter(t=>t.id!==e)):b(a.error||"Failed to delete catering option")}catch(e){b("An error occurred while deleting catering option")}}},handleCreateRentOption=async e=>{e.preventDefault(),R("");try{let e=await fetch("/api/training-room-rent-options",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...U,rent_per_hour:Number(U.rent_per_hour)})}),t=await e.json();t.success?(k([...w,t.data]),E(!1),L({name:"",description:"",rent_per_hour:"",is_active:!0})):R(t.error||"Failed to create rent option")}catch(e){R("An error occurred while creating rent option")}},handleEditRentOption=e=>{var t;T(e),M({name:e.name,description:e.description||"",rent_per_hour:e.rent_per_hour.toString(),is_active:null===(t=e.is_active)||void 0===t||t}),I(!0)},handleUpdateRentOption=async e=>{if(e.preventDefault(),O){R("");try{let e=await fetch("/api/training-room-rent-options/".concat(O.id),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({...P,rent_per_hour:Number(P.rent_per_hour)})}),t=await e.json();t.success?(k(w.map(e=>e.id===O.id?t.data:e)),I(!1),T(null),M({name:"",description:"",rent_per_hour:"",is_active:!0})):R(t.error||"Failed to update rent option")}catch(e){R("An error occurred while updating rent option")}}},handleDeleteRentOption=async e=>{if(confirm("Are you sure you want to delete this training room rent option?")){R("");try{let t=await fetch("/api/training-room-rent-options/".concat(e),{method:"DELETE"}),a=await t.json();a.success?k(w.filter(t=>t.id!==e)):R(a.error||"Failed to delete rent option")}catch(e){R("An error occurred while deleting rent option")}}},handleInputChange=e=>{let{name:t,value:a,type:r}=e.target,n=e.target.checked;v(e=>({...e,[t]:"checkbox"===r?n:a}))},handleEditInputChange=e=>{let{name:t,value:a,type:r}=e.target,n=e.target.checked;_(e=>({...e,[t]:"checkbox"===r?n:a}))},handleRentInputChange=e=>{let{name:t,value:a,type:r}=e.target,n=e.target.checked;L(e=>({...e,[t]:"checkbox"===r?n:a}))},handleEditRentInputChange=e=>{let{name:t,value:a,type:r}=e.target,n=e.target.checked;M(e=>({...e,[t]:"checkbox"===r?n:a}))};return(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-6xl mx-4 max-h-[90vh] overflow-y-auto",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Office Management"}),(0,r.jsx)("button",{onClick:t,className:"text-gray-400 hover:text-gray-600",children:"✕"})]}),(0,r.jsx)("div",{className:"border-b border-gray-200 mb-6",children:(0,r.jsxs)("nav",{className:"-mb-px flex space-x-8",children:[(0,r.jsx)("button",{onClick:()=>s("catering"),className:"py-2 px-1 border-b-2 font-medium text-sm ".concat("catering"===a?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:"Catering Options"}),(0,r.jsx)("button",{onClick:()=>s("rent"),className:"py-2 px-1 border-b-2 font-medium text-sm ".concat("rent"===a?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:"Training Room Rent"})]})}),f&&(0,r.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-4",children:(0,r.jsx)("p",{className:"text-red-800",children:f})}),Z&&(0,r.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-4",children:(0,r.jsx)("p",{className:"text-red-800",children:Z})}),"catering"===a&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,r.jsxs)("h4",{className:"text-md font-medium text-gray-900",children:["Catering Options (",i.length,")"]}),(0,r.jsxs)("button",{onClick:()=>u(!0),className:"btn-primary flex items-center",children:[(0,r.jsx)(S.Z,{className:"h-4 w-4 mr-2"}),"Add Catering Option"]})]}),c?(0,r.jsxs)("div",{className:"flex items-center justify-center py-8",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"}),(0,r.jsx)("span",{className:"ml-2 text-gray-600",children:"Loading catering options..."})]}):(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,r.jsx)("thead",{className:"bg-gray-50",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Description"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Lunch Price"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Dinner Price"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,r.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:i.map(e=>(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:e.name}),(0,r.jsx)("td",{className:"px-6 py-4 text-sm text-gray-500 max-w-xs truncate",children:e.description||"-"}),(0,r.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:["€",e.lunch_price_per_participant.toFixed(2)]}),(0,r.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:["€",e.dinner_price_per_participant.toFixed(2)]}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full ".concat(e.is_active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:e.is_active?"Active":"Inactive"})}),(0,r.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:[(0,r.jsx)("button",{onClick:()=>handleEditOption(e),className:"text-primary-600 hover:text-primary-900 mr-3",title:"Edit catering option",children:(0,r.jsx)(d.Z,{className:"h-4 w-4"})}),(0,r.jsx)("button",{onClick:()=>handleDeleteOption(e.id),className:"text-red-600 hover:text-red-900",title:"Delete catering option",children:(0,r.jsx)(o.Z,{className:"h-4 w-4"})})]})]},e.id))})]})}),x&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Add New Catering Option"}),(0,r.jsx)("button",{onClick:()=>u(!1),className:"text-gray-400 hover:text-gray-600",children:"✕"})]}),(0,r.jsxs)("form",{onSubmit:handleCreateOption,className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Name *"}),(0,r.jsx)("input",{type:"text",name:"name",required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-primary-500 focus:border-primary-500",value:j.name,onChange:handleInputChange})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Description"}),(0,r.jsx)("textarea",{name:"description",rows:3,className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-primary-500 focus:border-primary-500",value:j.description,onChange:handleInputChange})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Lunch Price (€) *"}),(0,r.jsx)("input",{type:"number",name:"lunch_price_per_participant",step:"0.01",min:"0",required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-primary-500 focus:border-primary-500",value:j.lunch_price_per_participant,onChange:handleInputChange})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Dinner Price (€) *"}),(0,r.jsx)("input",{type:"number",name:"dinner_price_per_participant",step:"0.01",min:"0",required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-primary-500 focus:border-primary-500",value:j.dinner_price_per_participant,onChange:handleInputChange})]})]}),(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("input",{type:"checkbox",name:"is_active",id:"is_active",className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded",checked:j.is_active,onChange:handleInputChange}),(0,r.jsx)("label",{htmlFor:"is_active",className:"ml-2 block text-sm text-gray-900",children:"Active"})]}),(0,r.jsxs)("div",{className:"flex justify-end space-x-3 pt-4",children:[(0,r.jsx)("button",{type:"button",onClick:()=>u(!1),className:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50",children:"Cancel"}),(0,r.jsx)("button",{type:"submit",className:"btn-primary",children:"Create Option"})]})]})]})}),p&&g&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Edit Catering Option"}),(0,r.jsx)("button",{onClick:()=>{h(!1),y(null)},className:"text-gray-400 hover:text-gray-600",children:"✕"})]}),(0,r.jsxs)("form",{onSubmit:handleUpdateOption,className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Name *"}),(0,r.jsx)("input",{type:"text",name:"name",required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-primary-500 focus:border-primary-500",value:N.name,onChange:handleEditInputChange})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Description"}),(0,r.jsx)("textarea",{name:"description",rows:3,className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-primary-500 focus:border-primary-500",value:N.description,onChange:handleEditInputChange})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Lunch Price (€) *"}),(0,r.jsx)("input",{type:"number",name:"lunch_price_per_participant",step:"0.01",min:"0",required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-primary-500 focus:border-primary-500",value:N.lunch_price_per_participant,onChange:handleEditInputChange})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Dinner Price (€) *"}),(0,r.jsx)("input",{type:"number",name:"dinner_price_per_participant",step:"0.01",min:"0",required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-primary-500 focus:border-primary-500",value:N.dinner_price_per_participant,onChange:handleEditInputChange})]})]}),(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("input",{type:"checkbox",name:"is_active",id:"edit_is_active",className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded",checked:N.is_active,onChange:handleEditInputChange}),(0,r.jsx)("label",{htmlFor:"edit_is_active",className:"ml-2 block text-sm text-gray-900",children:"Active"})]}),(0,r.jsxs)("div",{className:"flex justify-end space-x-3 pt-4",children:[(0,r.jsx)("button",{type:"button",onClick:()=>{h(!1),y(null)},className:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50",children:"Cancel"}),(0,r.jsx)("button",{type:"submit",className:"btn-primary",children:"Update Option"})]})]})]})})]}),"rent"===a&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,r.jsxs)("h4",{className:"text-md font-medium text-gray-900",children:["Training Room Rent Options (",w.length,")"]}),(0,r.jsxs)("button",{onClick:()=>E(!0),className:"btn-primary flex items-center",children:[(0,r.jsx)(S.Z,{className:"h-4 w-4 mr-2"}),"Add Rent Option"]})]}),C?(0,r.jsxs)("div",{className:"flex items-center justify-center py-8",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"}),(0,r.jsx)("span",{className:"ml-2 text-gray-600",children:"Loading rent options..."})]}):(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,r.jsx)("thead",{className:"bg-gray-50",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Description"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Rent Per Hour"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,r.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:w.map(e=>(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:e.name}),(0,r.jsx)("td",{className:"px-6 py-4 text-sm text-gray-500 max-w-xs truncate",children:e.description||"-"}),(0,r.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:["€",e.rent_per_hour.toFixed(2)]}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full ".concat(e.is_active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:e.is_active?"Active":"Inactive"})}),(0,r.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:[(0,r.jsx)("button",{onClick:()=>handleEditRentOption(e),className:"text-primary-600 hover:text-primary-900 mr-3",title:"Edit rent option",children:(0,r.jsx)(d.Z,{className:"h-4 w-4"})}),(0,r.jsx)("button",{onClick:()=>handleDeleteRentOption(e.id),className:"text-red-600 hover:text-red-900",title:"Delete rent option",children:(0,r.jsx)(o.Z,{className:"h-4 w-4"})})]})]},e.id))})]})})]}),A&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold",children:"Add New Training Room Rent Option"}),(0,r.jsx)("button",{onClick:()=>E(!1),className:"text-gray-400 hover:text-gray-600",children:"✕"})]}),(0,r.jsxs)("form",{onSubmit:handleCreateRentOption,className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Name *"}),(0,r.jsx)("input",{type:"text",name:"name",required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-primary-500 focus:border-primary-500",value:U.name,onChange:handleRentInputChange})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Description"}),(0,r.jsx)("textarea",{name:"description",rows:3,className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-primary-500 focus:border-primary-500",value:U.description,onChange:handleRentInputChange})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Rent Per Hour (€) *"}),(0,r.jsx)("input",{type:"number",name:"rent_per_hour",step:"0.01",min:"0",required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-primary-500 focus:border-primary-500",value:U.rent_per_hour,onChange:handleRentInputChange})]}),(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("input",{type:"checkbox",name:"is_active",id:"is_active_rent",className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded",checked:U.is_active,onChange:handleRentInputChange}),(0,r.jsx)("label",{htmlFor:"is_active_rent",className:"ml-2 block text-sm text-gray-900",children:"Active"})]}),(0,r.jsxs)("div",{className:"flex justify-end space-x-3 pt-4",children:[(0,r.jsx)("button",{type:"button",onClick:()=>E(!1),className:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50",children:"Cancel"}),(0,r.jsx)("button",{type:"submit",className:"btn-primary",children:"Create Option"})]})]})]})}),D&&O&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold",children:"Edit Training Room Rent Option"}),(0,r.jsx)("button",{onClick:()=>{I(!1),T(null)},className:"text-gray-400 hover:text-gray-600",children:"✕"})]}),(0,r.jsxs)("form",{onSubmit:handleUpdateRentOption,className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Name *"}),(0,r.jsx)("input",{type:"text",name:"name",required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-primary-500 focus:border-primary-500",value:P.name,onChange:handleEditRentInputChange})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Description"}),(0,r.jsx)("textarea",{name:"description",rows:3,className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-primary-500 focus:border-primary-500",value:P.description,onChange:handleEditRentInputChange})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Rent Per Hour (€) *"}),(0,r.jsx)("input",{type:"number",name:"rent_per_hour",step:"0.01",min:"0",required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-primary-500 focus:border-primary-500",value:P.rent_per_hour,onChange:handleEditRentInputChange})]}),(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("input",{type:"checkbox",name:"is_active",id:"edit_is_active_rent",className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded",checked:P.is_active,onChange:handleEditRentInputChange}),(0,r.jsx)("label",{htmlFor:"edit_is_active_rent",className:"ml-2 block text-sm text-gray-900",children:"Active"})]}),(0,r.jsxs)("div",{className:"flex justify-end space-x-3 pt-4",children:[(0,r.jsx)("button",{type:"button",onClick:()=>{I(!1),T(null)},className:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50",children:"Cancel"}),(0,r.jsx)("button",{type:"submit",className:"btn-primary",children:"Update Option"})]})]})]})})]})})}var A=a(4935);function Home(){let{user:e,logout:t}=(0,F.useAuth)(),[a,s]=(0,n.useState)([]),[i,c]=(0,n.useState)(!0),[d,o]=(0,n.useState)(!1),[m,x]=(0,n.useState)(!1),[u,p]=(0,n.useState)(!1),[g,y]=(0,n.useState)(null),[f,v]=(0,n.useState)("invoices"),[N,_]=(0,n.useState)({search:"",customer:"",months:[],years:[],minAmount:"",maxAmount:""}),[w,E]=(0,n.useState)({search:"",customer:"",months:[],years:[],taskStatus:""}),fetchInvoices=async()=>{try{c(!0);let e=await fetch("/api/training-invoices"),t=await e.json();t.success?s(t.data):y(t.error||"Failed to fetch invoices")}catch(e){y("Failed to fetch invoices")}finally{c(!1)}};(0,n.useEffect)(()=>{fetchInvoices()},[]);let handleInvoiceUpdated=e=>{s(a.map(t=>t.id===e.id?e:t))},D=getUniqueCustomers(a),I=getAvailableMonths(a),O=getAvailableYears(a),T="invoices"===f?filterInvoices(a,N):filterAdminTasks(a,w),Z=T.reduce((e,t)=>e+t.total_invoice_amount,0),R=T.length;return i?(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-primary-600"})}):e?(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center bg-white p-4 rounded-lg shadow-sm border",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsx)("div",{className:"p-2 bg-primary-100 rounded-full",children:(0,r.jsx)(k.Z,{className:"h-5 w-5 text-primary-600"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-medium text-gray-900",children:null==e?void 0:e.name}),(0,r.jsx)("p",{className:"text-xs text-gray-500 capitalize",children:null==e?void 0:e.role})]})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[((null==e?void 0:e.role)==="admin"||(null==e?void 0:e.role)==="manager")&&(0,r.jsxs)("button",{onClick:()=>p(!0),className:"flex items-center space-x-2 px-3 py-2 text-sm font-medium text-gray-700 hover:text-gray-900 hover:bg-gray-100 rounded-md transition-colors",children:[(0,r.jsx)(h.Z,{className:"h-4 w-4"}),(0,r.jsx)("span",{children:"Office"})]}),(null==e?void 0:e.role)==="admin"&&(0,r.jsxs)("button",{onClick:()=>x(!0),className:"flex items-center space-x-2 px-3 py-2 text-sm font-medium text-gray-700 hover:text-gray-900 hover:bg-gray-100 rounded-md transition-colors",children:[(0,r.jsx)(l.Z,{className:"h-4 w-4"}),(0,r.jsx)("span",{children:"Users"})]}),(0,r.jsxs)("button",{onClick:t,className:"flex items-center space-x-2 px-3 py-2 text-sm font-medium text-gray-700 hover:text-gray-900 hover:bg-gray-100 rounded-md transition-colors",children:[(0,r.jsx)(C.Z,{className:"h-4 w-4"}),(0,r.jsx)("span",{children:"Logout"})]})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,r.jsx)("div",{className:"card",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"p-2 bg-green-100 rounded-lg",children:(0,r.jsx)(b.Z,{className:"h-6 w-6 text-green-600"})}),(0,r.jsxs)("div",{className:"ml-4",children:[(0,r.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Total Trainings"}),(0,r.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:R})]})]})}),(0,r.jsx)("div",{className:"card",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"p-2 bg-blue-100 rounded-lg",children:(0,r.jsx)(b.Z,{className:"h-6 w-6 text-blue-600"})}),(0,r.jsxs)("div",{className:"ml-4",children:[(0,r.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Total Revenue"}),(0,r.jsxs)("p",{className:"text-2xl font-bold text-gray-900",children:["€",Z.toLocaleString("nl-NL",{minimumFractionDigits:2})]})]})]})})]}),(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsxs)("div",{className:"flex space-x-8",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Training Management"}),(0,r.jsxs)("div",{className:"flex border-b border-gray-200",children:[(0,r.jsxs)("button",{className:"px-4 py-2 -mb-px border-b-2 font-medium text-sm focus:outline-none ".concat("invoices"===f?"border-primary-600 text-primary-700":"border-transparent text-gray-500 hover:text-gray-700"),onClick:()=>v("invoices"),children:[(0,r.jsx)(b.Z,{className:"h-4 w-4 inline mr-2"}),"Invoices"]}),(null==e?void 0:e.role)==="admin"&&(0,r.jsxs)("button",{className:"px-4 py-2 -mb-px border-b-2 font-medium text-sm focus:outline-none ".concat("admin"===f?"border-primary-600 text-primary-700":"border-transparent text-gray-500 hover:text-gray-700"),onClick:()=>v("admin"),children:[(0,r.jsx)(j.Z,{className:"h-4 w-4 inline mr-2"}),"Administrative Tasks"]})]})]}),(0,r.jsxs)("button",{onClick:()=>o(!0),className:"btn-primary flex items-center",children:[(0,r.jsx)(S.Z,{className:"h-4 w-4 mr-2"}),"Add Training Invoice"]})]}),g&&(0,r.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:(0,r.jsx)("p",{className:"text-red-800",children:g})}),d&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-[705px] mx-4 max-h-[90vh] overflow-y-auto",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold",children:"Add New Training Invoice"}),(0,r.jsx)("button",{onClick:()=>o(!1),className:"text-gray-400 hover:text-gray-600",children:"✕"})]}),(0,r.jsx)(InvoiceForm,{onSuccess:e=>{s([e,...a]),o(!1)},onCancel:()=>o(!1)})]})}),i?(0,r.jsx)("div",{className:"card",children:(0,r.jsxs)("div",{className:"flex items-center justify-center py-8",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"}),(0,r.jsx)("span",{className:"ml-2 text-gray-600",children:"Loading invoices..."})]})}):(0,r.jsxs)(r.Fragment,{children:["invoices"===f&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(InvoiceFilters,{onFilterChange:_,customers:D,months:I,years:O}),(0,r.jsx)(InvoiceList,{invoices:T,onUpdate:handleInvoiceUpdated,onDelete:e=>{s(a.filter(t=>t.id!==e))}})]}),"admin"===f&&(null==e?void 0:e.role)==="admin"&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(AdminFilters,{onFilterChange:E,customers:D,months:I,years:O}),(0,r.jsx)(AdminTasksTable,{invoices:T,onUpdate:handleInvoiceUpdated})]})]}),m&&(0,r.jsx)(UserManagement,{onClose:()=>x(!1)}),u&&(0,r.jsx)(OfficeManagement,{onClose:()=>p(!1)})]}):(0,r.jsx)(A.Z,{})}},4935:function(e,t,a){"use strict";a.d(t,{Z:function(){return LoginForm}});var r=a(7437),n=a(2265),s=a(4033),i=a(1097),l=a(7216),c=a(9670),d=a(3549);function LoginForm(e){let{onLoginSuccess:t}=e,{login:a}=(0,d.useAuth)(),[o,m]=(0,n.useState)({username:"",password:""}),[x,u]=(0,n.useState)(!1),[p,h]=(0,n.useState)(!1),[g,y]=(0,n.useState)("");(0,s.useRouter)();let handleSubmit=async e=>{e.preventDefault(),h(!0),y("");try{let e=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)}),r=await e.json();r.success?(a(r.user),null==t||t(r.user)):y(r.error||"Login failed")}catch(e){console.error("Login error:",e),y("An error occurred during login")}finally{h(!1)}},handleInputChange=e=>{let{name:t,value:a}=e.target;m(e=>({...e,[t]:a}))};return(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:(0,r.jsxs)("div",{className:"max-w-md w-full space-y-8",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"mx-auto h-12 w-12 flex items-center justify-center rounded-full bg-primary-100",children:(0,r.jsx)(i.Z,{className:"h-6 w-6 text-primary-600"})}),(0,r.jsx)("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:"Sign in to your account"}),(0,r.jsx)("p",{className:"mt-2 text-center text-sm text-gray-600",children:"Training Management System"})]}),(0,r.jsxs)("form",{className:"mt-8 space-y-6",onSubmit:handleSubmit,children:[(0,r.jsxs)("div",{className:"rounded-md shadow-sm -space-y-px",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"username",className:"sr-only",children:"Username"}),(0,r.jsx)("input",{id:"username",name:"username",type:"text",required:!0,className:"appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-t-md focus:outline-none focus:ring-primary-500 focus:border-primary-500 focus:z-10 sm:text-sm",placeholder:"Username",value:o.username,onChange:handleInputChange})]}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("label",{htmlFor:"password",className:"sr-only",children:"Password"}),(0,r.jsx)("input",{id:"password",name:"password",type:x?"text":"password",required:!0,className:"appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-b-md focus:outline-none focus:ring-primary-500 focus:border-primary-500 focus:z-10 sm:text-sm",placeholder:"Password",value:o.password,onChange:handleInputChange}),(0,r.jsx)("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center",onClick:()=>u(!x),children:x?(0,r.jsx)(l.Z,{className:"h-5 w-5 text-gray-400"}):(0,r.jsx)(c.Z,{className:"h-5 w-5 text-gray-400"})})]})]}),g&&(0,r.jsx)("div",{className:"rounded-md bg-red-50 p-4",children:(0,r.jsx)("div",{className:"flex",children:(0,r.jsx)("div",{className:"ml-3",children:(0,r.jsx)("h3",{className:"text-sm font-medium text-red-800",children:g})})})}),(0,r.jsx)("div",{children:(0,r.jsx)("button",{type:"submit",disabled:p,className:"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50 disabled:cursor-not-allowed",children:p?(0,r.jsx)("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("span",{className:"absolute left-0 inset-y-0 flex items-center pl-3",children:(0,r.jsx)(i.Z,{className:"h-5 w-5 text-primary-500 group-hover:text-primary-400"})}),"Sign in"]})})})]})]})})}},3549:function(e,t,a){"use strict";a.r(t),a.d(t,{AuthProvider:function(){return AuthProvider},useAuth:function(){return useAuth}});var r=a(7437),n=a(2265);let s=(0,n.createContext)(void 0);function AuthProvider(e){let{children:t}=e,[a,i]=(0,n.useState)(null),[l,c]=(0,n.useState)(!0),checkAuth=async()=>{try{let e=await fetch("/api/auth/session");if(e.ok){let t=await e.json();t.success&&i(t.user)}}catch(e){console.error("Auth check failed:",e)}finally{c(!1)}},logout=async()=>{try{await fetch("/api/auth/logout",{method:"POST"})}catch(e){console.error("Logout failed:",e)}finally{i(null)}};return(0,n.useEffect)(()=>{checkAuth()},[]),(0,r.jsx)(s.Provider,{value:{user:a,loading:l,login:e=>{i(e)},logout,checkAuth},children:t})}function useAuth(){let e=(0,n.useContext)(s);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}}},function(e){e.O(0,[389,971,472,744],function(){return e(e.s=296)}),_N_E=e.O()}]);