"use strict";(()=>{var e={};e.id=210,e.ids=[210],e.modules={5890:e=>{e.exports=require("better-sqlite3")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},1017:e=>{e.exports=require("path")},8799:(e,i,n)=>{n.r(i),n.d(i,{headerHooks:()=>g,originalPathname:()=>f,requestAsyncStorage:()=>l,routeModule:()=>_,serverHooks:()=>p,staticGenerationAsyncStorage:()=>m,staticGenerationBailout:()=>v});var t={};n.r(t),n.d(t,{GET:()=>GET,POST:()=>POST});var r=n(884),a=n(6132),o=n(5798),s=n(8307),c=n(1538),u=n(1045);let d=c.Ry({invoice_number:c.Z_().optional(),invoice_date:c.Z_().optional(),customer:c.Z_().min(1,"Customer is required"),training_name:c.Z_().min(1,"Training name is required"),training_dates:c.IX(c.Ry({date:c.Z_().min(1,"Date is required"),start_time:c.Z_().min(1,"Start time is required"),end_time:c.Z_().min(1,"End time is required")})).min(1,"At least one date is required"),trainer_costs:c.Rx().min(0,"Trainer costs must be non-negative"),office_costs:c.Rx().min(0,"Office costs must be non-negative"),margin_percentage:c.Rx().min(0,"Margin percentage must be non-negative"),total_invoice_amount:c.Rx().min(0,"Total invoice amount must be non-negative"),trainer_availability_emailed:c.O7().optional(),masterclass_planning_added:c.O7().optional(),lms_updated:c.O7().optional(),navara_event_agenda_updated:c.O7().optional(),catering_ordered:c.O7().optional(),trainer_invoice_received:c.O7().optional()});async function GET(){try{let e=(0,s.N)(),i=e.getAllTrainingInvoices();return o.Z.json({success:!0,data:i})}catch(e){return console.error("Error fetching training invoices:",e),o.Z.json({success:!1,error:"Failed to fetch training invoices"},{status:500})}}async function POST(e){try{let i=await e.json(),n=d.parse(i),t=(0,s.N)(),r=Array.from(new Set(n.training_dates.map(e=>e.date))),a=r.length,c=n.total_invoice_amount;c||(c=t.calculateTotalAmount(n.trainer_costs,n.office_costs,n.margin_percentage));let u=t.createTrainingInvoice({...n,invoice_number:n.invoice_number??"",training_dates:n.training_dates,duration_days:a,total_invoice_amount:c});return o.Z.json({success:!0,data:u},{status:201})}catch(e){if(console.error("Error creating training invoice:",e),e instanceof u.jm)return o.Z.json({success:!1,error:"Validation error",details:e.errors},{status:400});return o.Z.json({success:!1,error:"Failed to create training invoice"},{status:500})}}let _=new r.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/training-invoices/route",pathname:"/api/training-invoices",filename:"route",bundlePath:"app/api/training-invoices/route"},resolvedPagePath:"C:\\Users\\wesle\\OneDrive\\Documenten\\Wesley code\\Finance\\src\\app\\api\\training-invoices\\route.ts",nextConfigOutput:"",userland:t}),{requestAsyncStorage:l,staticGenerationAsyncStorage:m,serverHooks:p,headerHooks:g,staticGenerationBailout:v}=_,f="/api/training-invoices/route"}};var i=require("../../../webpack-runtime.js");i.C(e);var __webpack_exec__=e=>i(i.s=e),n=i.X(0,[542,307],()=>__webpack_exec__(8799));module.exports=n})();