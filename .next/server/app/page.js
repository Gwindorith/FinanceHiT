(()=>{var e={};e.id=931,e.ids=[931],e.modules={5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},5528:e=>{"use strict";e.exports=require("next/dist\\client\\components\\action-async-storage.external.js")},1877:e=>{"use strict";e.exports=require("next/dist\\client\\components\\request-async-storage.external.js")},5319:e=>{"use strict";e.exports=require("next/dist\\client\\components\\static-generation-async-storage.external.js")},7310:e=>{"use strict";e.exports=require("url")},2390:(e,t,a)=>{"use strict";a.r(t),a.d(t,{GlobalError:()=>n.a,__next_app__:()=>x,originalPathname:()=>m,pages:()=>o,routeModule:()=>u,tree:()=>d});var s=a(7096),i=a(6132),r=a(7284),n=a.n(r),l=a(2564),c={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>l[e]);a.d(t,c);let d=["",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,8203)),"C:\\Users\\wesle\\OneDrive\\Documenten\\Wesley code\\Finance\\src\\app\\page.tsx"]}]},{layout:[()=>Promise.resolve().then(a.bind(a,9113)),"C:\\Users\\wesle\\OneDrive\\Documenten\\Wesley code\\Finance\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(a.t.bind(a,9291,23)),"next/dist/client/components/not-found-error"]}],o=["C:\\Users\\wesle\\OneDrive\\Documenten\\Wesley code\\Finance\\src\\app\\page.tsx"],m="/page",x={require:a,loadChunk:()=>Promise.resolve()},u=new s.AppPageRouteModule({definition:{kind:i.x.APP_PAGE,page:"/page",pathname:"/",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},9245:(e,t,a)=>{Promise.resolve().then(a.bind(a,3891))},3891:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>Home});var s=a(784),i=a(9885),r=a(1866),n=a(9763),l=a(1672),c=a(4782),d=a(9494),o=a(6303),m=a(6558),x=a(3894),u=a(5830);function ParticipantsTable({trainingInvoiceId:e}){let[t,a]=(0,i.useState)([]),[r,n]=(0,i.useState)(!0),[l,c]=(0,i.useState)(null),[d,o]=(0,i.useState)({name:"",email:"",company:""}),[m,x]=(0,i.useState)(null),[u,p]=(0,i.useState)({name:"",email:"",company:""}),fetchParticipants=async()=>{n(!0);try{let t=await fetch(`/api/participants?training_invoice_id=${e}`),s=await t.json();s.success?a(s.data):c(s.error||"Failed to fetch participants")}catch(e){c("Failed to fetch participants")}finally{n(!1)}};(0,i.useEffect)(()=>{fetchParticipants()},[e]);let handleAdd=async s=>{s.preventDefault(),c(null);try{let s=await fetch(`/api/participants?training_invoice_id=${e}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(d)}),i=await s.json();i.success?(a([...t,i.data]),o({name:"",email:"",company:""})):c(i.error||"Failed to add participant")}catch(e){c("Failed to add participant")}},handleEdit=e=>{x(e.id),p({name:e.name,email:e.email,company:e.company})},handleEditSave=async e=>{c(null);try{let s=await fetch(`/api/participants/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(u)}),i=await s.json();i.success?(a(t.map(t=>t.id===e?i.data:t)),x(null)):c(i.error||"Failed to update participant")}catch(e){c("Failed to update participant")}},handleDelete=async e=>{c(null);try{let s=await fetch(`/api/participants/${e}`,{method:"DELETE"}),i=await s.json();i.success?a(t.filter(t=>t.id!==e)):c(i.error||"Failed to delete participant")}catch(e){c("Failed to delete participant")}};return(0,s.jsxs)("div",{className:"mt-8",children:[s.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Participants"}),l&&s.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-2 mb-2 text-red-800",children:l}),(0,s.jsxs)("form",{onSubmit:handleAdd,className:"mb-4 flex flex-col md:flex-row gap-2",children:[s.jsx("input",{type:"text",placeholder:"Name",className:"input-field text-black",value:d.name,onChange:e=>o({...d,name:e.target.value}),required:!0}),s.jsx("input",{type:"email",placeholder:"Email",className:"input-field text-black",value:d.email,onChange:e=>o({...d,email:e.target.value}),required:!0}),s.jsx("input",{type:"text",placeholder:"Company",className:"input-field text-black",value:d.company,onChange:e=>o({...d,company:e.target.value}),required:!0}),s.jsx("button",{type:"submit",className:"btn-primary",children:"Add"})]}),s.jsx("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[s.jsx("thead",{className:"bg-gray-50",children:(0,s.jsxs)("tr",{children:[s.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider text-black",children:"Name"}),s.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider text-black",children:"Email"}),s.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider text-black",children:"Company"}),s.jsx("th",{className:"px-4 py-2 text-right text-xs font-medium text-gray-500 uppercase tracking-wider text-black",children:"Actions"})]})}),s.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:r?s.jsx("tr",{children:s.jsx("td",{colSpan:4,className:"text-center py-4",children:"Loading..."})}):0===t.length?s.jsx("tr",{children:s.jsx("td",{colSpan:4,className:"text-center py-4 text-gray-500",children:"No participants"})}):t.map(e=>(0,s.jsxs)("tr",{children:[s.jsx("td",{className:"px-4 py-2 text-black",children:m===e.id?s.jsx("input",{type:"text",className:"input-field text-black",value:u.name,onChange:e=>p({...u,name:e.target.value}),required:!0}):e.name}),s.jsx("td",{className:"px-4 py-2 text-black",children:m===e.id?s.jsx("input",{type:"email",className:"input-field text-black",value:u.email,onChange:e=>p({...u,email:e.target.value}),required:!0}):e.email}),s.jsx("td",{className:"px-4 py-2 text-black",children:m===e.id?s.jsx("input",{type:"text",className:"input-field text-black",value:u.company,onChange:e=>p({...u,company:e.target.value}),required:!0}):e.company}),s.jsx("td",{className:"px-4 py-2 text-right text-black",children:m===e.id?(0,s.jsxs)(s.Fragment,{children:[s.jsx("button",{className:"btn-primary mr-2",onClick:()=>handleEditSave(e.id),children:"Save"}),s.jsx("button",{className:"btn-secondary",onClick:()=>x(null),children:"Cancel"})]}):(0,s.jsxs)(s.Fragment,{children:[s.jsx("button",{className:"btn-secondary mr-2",onClick:()=>handleEdit(e),children:"Edit"}),s.jsx("button",{className:"btn-danger",onClick:()=>handleDelete(e.id),children:"Delete"})]})})]},e.id))})]})})]})}let p=u.Ry({invoice_number:u.Z_().optional(),invoice_date:u.Z_().optional(),customer:u.Z_().min(1,"Customer is required"),training_name:u.Z_().min(1,"Training name is required"),training_dates:u.IX(u.Ry({date:u.Z_().min(1,"Date is required"),start_time:u.Z_().min(1,"Start time is required"),end_time:u.Z_().min(1,"End time is required")})).min(1,"At least one date is required"),trainer_costs:u.Rx().min(0,"Trainer costs must be non-negative"),office_costs:u.Rx().min(0,"Office costs must be non-negative"),margin_percentage:u.Rx().min(0,"Margin percentage must be non-negative"),total_invoice_amount:u.Rx().min(0,"Total invoice amount must be non-negative")});function InvoiceForm({invoice:e,onSuccess:t,onCancel:a}){let[r,n]=(0,i.useState)(!1),[l,c]=(0,i.useState)(0),[d,o]=(0,i.useState)(1),[u,h]=(0,i.useState)(e?e.training_dates:[{date:"",start_time:"09:00",end_time:"17:00"}]),[g,y]=(0,i.useState)("details");console.log("Training Dates:",u);let{register:f,handleSubmit:b,watch:j,setValue:v,control:N,formState:{errors:_}}=(0,m.cI)({resolver:(0,x.F)(p),defaultValues:e?{invoice_number:e.invoice_number??"",invoice_date:e.invoice_date??"",customer:e.customer,training_name:e.training_name,training_dates:e.training_dates,trainer_costs:e.trainer_costs,office_costs:e.office_costs,margin_percentage:e.margin_percentage,total_invoice_amount:e.total_invoice_amount}:{invoice_number:"",invoice_date:"",customer:"",training_name:"",training_dates:[{date:"",start_time:"09:00",end_time:"17:00"}],trainer_costs:0,office_costs:0,margin_percentage:25,total_invoice_amount:0}});(0,i.useEffect)(()=>{v("training_dates",u)},[u,v]),(0,i.useEffect)(()=>{0===u.length&&h([{date:"",start_time:"09:00",end_time:"17:00"}])},[u]);let w=j(["training_dates","trainer_costs","office_costs","margin_percentage"]);(0,i.useEffect)(()=>{let[e,t,a,s]=w;if(Array.isArray(e)){let t=Array.from(new Set(e.filter(e=>e.date).map(e=>e.date)));o(t.length)}if(void 0!==t&&void 0!==a&&void 0!==s){let e=t+a+t*(s/100);c(e),v("total_invoice_amount",e)}},[w,v]);let onSubmit=async a=>{n(!0);try{let s=e?`/api/training-invoices/${e.id}`:"/api/training-invoices",i=e?"PUT":"POST",r=await fetch(s,{method:i,headers:{"Content-Type":"application/json"},body:JSON.stringify(a)}),n=await r.json();n.success?t(n.data):alert(n.error||"Failed to save invoice")}catch(e){alert("Failed to save invoice")}finally{n(!1)}};return(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex border-b mb-4",children:[s.jsx("button",{className:`px-4 py-2 -mb-px border-b-2 font-medium focus:outline-none ${"details"===g?"border-primary-600 text-primary-700":"border-transparent text-gray-500"}`,onClick:()=>y("details"),children:"Invoice Details"}),e?.id&&s.jsx("button",{className:`px-4 py-2 -mb-px border-b-2 font-medium focus:outline-none ${"participants"===g?"border-primary-600 text-primary-700":"border-transparent text-gray-500"}`,onClick:()=>y("participants"),children:"Participants"})]}),"details"===g&&(0,s.jsxs)("form",{onSubmit:b(onSubmit),className:"space-y-6",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{children:[s.jsx("label",{htmlFor:"invoice_number",className:"block text-sm font-medium text-gray-700",children:"Invoice Number"}),s.jsx("input",{type:"text",id:"invoice_number",...f("invoice_number"),className:"input-field mt-1 text-black",placeholder:"Enter invoice number (optional)"})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{htmlFor:"invoice_date",className:"block text-sm font-medium text-gray-700",children:"Invoice Date *"}),s.jsx("input",{type:"date",id:"invoice_date",...f("invoice_date"),className:"input-field mt-1 text-black"}),_.invoice_date&&s.jsx("p",{className:"mt-1 text-sm text-red-600",children:_.invoice_date.message})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{htmlFor:"customer",className:"block text-sm font-medium text-gray-700",children:"Customer *"}),s.jsx("input",{type:"text",id:"customer",...f("customer"),className:"input-field mt-1 text-black",placeholder:"Enter customer name"}),_.customer&&s.jsx("p",{className:"mt-1 text-sm text-red-600",children:_.customer.message})]}),(0,s.jsxs)("div",{className:"md:col-span-2",children:[s.jsx("label",{htmlFor:"training_name",className:"block text-sm font-medium text-gray-700",children:"Training Name *"}),s.jsx("input",{type:"text",id:"training_name",...f("training_name"),className:"input-field mt-1 text-black",placeholder:"Enter training name"}),_.training_name&&s.jsx("p",{className:"mt-1 text-sm text-red-600",children:_.training_name.message})]}),(0,s.jsxs)("div",{className:"md:col-span-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Training Dates *"}),s.jsx("div",{className:"space-y-2",children:u.map((e,t)=>(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[s.jsx("input",{type:"date",value:e.date||"",onChange:e=>{let a=[...u];a[t]={...a[t],date:e.target.value},h(a)},className:"input-field text-black"}),(0,s.jsxs)("div",{className:"flex items-center space-x-1",children:[s.jsx("label",{className:"text-xs text-gray-500 whitespace-nowrap",children:"Start:"}),s.jsx("input",{type:"time",value:e.start_time||"",onChange:e=>{let a=[...u];a[t]={...a[t],start_time:e.target.value},h(a)},className:"input-field text-black w-28",step:"900",required:!0,pattern:"[0-9]{2}:[0-9]{2}",inputMode:"numeric",lang:"en"})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-1",children:[s.jsx("label",{className:"text-xs text-gray-500 whitespace-nowrap",children:"End:"}),s.jsx("input",{type:"time",value:e.end_time||"",onChange:e=>{let a=[...u];a[t]={...a[t],end_time:e.target.value},h(a)},className:"input-field text-black w-28",step:"900",required:!0,pattern:"[0-9]{2}:[0-9]{2}",inputMode:"numeric",lang:"en"})]}),s.jsx("button",{type:"button",onClick:()=>h(u.filter((e,a)=>a!==t)),className:"btn-secondary px-2 py-1",disabled:1===u.length,title:"Remove date",children:"–"})]},t))}),s.jsx("div",{className:"mt-2",children:s.jsx("button",{type:"button",onClick:()=>h([...u,{date:"",start_time:"09:00",end_time:"17:00"}]),className:"btn-primary text-sm px-3 py-1",title:"Add training date",children:"+ Add Training Date"})}),_.training_dates&&s.jsx("p",{className:"mt-1 text-sm text-red-600",children:Array.isArray(_.training_dates)?_.training_dates.map((e,t)=>e?.message&&(0,s.jsxs)("span",{children:[e.message,s.jsx("br",{})]},t)):_.training_dates?.message})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Duration (Days)"}),s.jsx("input",{type:"number",value:d,readOnly:!0,className:"input-field mt-1 bg-gray-50 text-black"})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{htmlFor:"margin_percentage",className:"block text-sm font-medium text-gray-700",children:"Margin Percentage (%) *"}),s.jsx("input",{type:"number",id:"margin_percentage",...f("margin_percentage",{valueAsNumber:!0}),className:"input-field mt-1 text-black",min:"0",step:"0.01",placeholder:"25"}),_.margin_percentage&&s.jsx("p",{className:"mt-1 text-sm text-red-600",children:_.margin_percentage.message})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{htmlFor:"trainer_costs",className:"block text-sm font-medium text-gray-700",children:"Trainer Costs (€) *"}),s.jsx("input",{type:"number",id:"trainer_costs",...f("trainer_costs",{valueAsNumber:!0}),className:"input-field mt-1 text-black",min:"0",step:"0.01",placeholder:"0.00"}),_.trainer_costs&&s.jsx("p",{className:"mt-1 text-sm text-red-600",children:_.trainer_costs.message})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{htmlFor:"office_costs",className:"block text-sm font-medium text-gray-700",children:"Office Costs (€) *"}),s.jsx("input",{type:"number",id:"office_costs",...f("office_costs",{valueAsNumber:!0}),className:"input-field mt-1 text-black",min:"0",step:"0.01",placeholder:"0.00"}),_.office_costs&&s.jsx("p",{className:"mt-1 text-sm text-red-600",children:_.office_costs.message})]}),(0,s.jsxs)("div",{className:"md:col-span-2",children:[s.jsx("label",{htmlFor:"total_invoice_amount",className:"block text-sm font-medium text-gray-700",children:"Total Invoice Amount (€) *"}),s.jsx("input",{type:"number",id:"total_invoice_amount",...f("total_invoice_amount",{valueAsNumber:!0}),className:"input-field mt-1 bg-gray-50 text-black",min:"0",step:"0.01",placeholder:"0.00",readOnly:!0}),s.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Calculated automatically based on costs and margin"}),_.total_invoice_amount&&s.jsx("p",{className:"mt-1 text-sm text-red-600",children:_.total_invoice_amount.message})]})]}),(0,s.jsxs)("div",{className:"flex justify-end space-x-3 pt-6 border-t",children:[s.jsx("button",{type:"button",onClick:a,className:"btn-secondary",disabled:r,children:"Cancel"}),s.jsx("button",{type:"submit",className:"btn-primary",disabled:r,children:r?"Saving...":e?"Update Invoice":"Create Invoice"})]})]}),"participants"===g&&e?.id&&s.jsx(ParticipantsTable,{trainingInvoiceId:e.id})]})}function InvoiceList({invoices:e,onUpdate:t,onDelete:a}){let[m,x]=(0,i.useState)(null),[u,p]=(0,i.useState)(null),handleEdit=e=>{x(e)},handleDelete=async e=>{if(confirm("Are you sure you want to delete this training invoice?"))try{p(e);let t=await fetch(`/api/training-invoices/${e}`,{method:"DELETE"});if(t.ok)a(e);else{let e=await t.json();alert(e.error||"Failed to delete invoice")}}catch(e){alert("Failed to delete invoice")}finally{p(null)}};return 0===e.length?s.jsx("div",{className:"card",children:(0,s.jsxs)("div",{className:"text-center py-12",children:[s.jsx(n.Z,{className:"mx-auto h-12 w-12 text-gray-400"}),s.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No training invoices"}),s.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Get started by creating your first training invoice."})]})}):(0,s.jsxs)(s.Fragment,{children:[s.jsx("div",{className:"card overflow-hidden",children:s.jsx("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[s.jsx("thead",{className:"bg-gray-50",children:(0,s.jsxs)("tr",{children:[s.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-24",children:"Invoice #"}),s.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-24",children:"Date"}),s.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider min-w-0 flex-1",children:"Training"}),s.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-20",children:"Days"}),s.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-32",children:"Costs"}),s.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-16",children:"Margin"}),s.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-28",children:"Total"}),s.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider min-w-0 flex-1",children:"Customer"}),s.jsx("th",{className:"px-3 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider w-20",children:"Actions"})]})}),s.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(e=>(0,s.jsxs)("tr",{className:"hover:bg-gray-50",children:[s.jsx("td",{className:"px-3 py-4 whitespace-nowrap",children:s.jsx("div",{className:"text-sm text-gray-900",children:e.invoice_number||s.jsx("span",{className:"text-gray-400 italic",children:"-"})})}),s.jsx("td",{className:"px-3 py-4 whitespace-nowrap",children:s.jsx("div",{className:"text-sm text-gray-900",children:e.invoice_date?(0,r.Z)(new Date(e.invoice_date),"dd-MM-yyyy"):"-"})}),s.jsx("td",{className:"px-3 py-4",children:s.jsx("div",{className:"text-sm font-medium text-gray-900 truncate",children:e.training_name})}),s.jsx("td",{className:"px-3 py-4 whitespace-nowrap",children:(0,s.jsxs)("div",{className:"flex items-center text-sm text-gray-900",children:[s.jsx(l.Z,{className:"h-4 w-4 mr-1 text-gray-400"}),e.duration_days]})}),s.jsx("td",{className:"px-3 py-4 whitespace-nowrap",children:(0,s.jsxs)("div",{className:"text-sm text-gray-900",children:[(0,s.jsxs)("div",{children:["€",e.trainer_costs.toLocaleString("nl-NL",{minimumFractionDigits:0})]}),(0,s.jsxs)("div",{children:["€",e.office_costs.toLocaleString("nl-NL",{minimumFractionDigits:0})]})]})}),s.jsx("td",{className:"px-3 py-4 whitespace-nowrap",children:(0,s.jsxs)("div",{className:"text-sm text-gray-900",children:[e.margin_percentage,"%"]})}),s.jsx("td",{className:"px-3 py-4 whitespace-nowrap",children:(0,s.jsxs)("div",{className:"flex items-center text-sm font-medium text-gray-900",children:[s.jsx(c.Z,{className:"h-4 w-4 mr-1 text-green-600"}),"€",e.total_invoice_amount.toLocaleString("nl-NL",{minimumFractionDigits:0})]})}),s.jsx("td",{className:"px-3 py-4",children:s.jsx("div",{className:"text-sm text-gray-900 truncate",children:e.customer})}),s.jsx("td",{className:"px-3 py-4 whitespace-nowrap text-right text-sm font-medium",children:(0,s.jsxs)("div",{className:"flex items-center justify-end space-x-1",children:[s.jsx("button",{onClick:()=>handleEdit(e),className:"text-primary-600 hover:text-primary-900 p-1",title:"Edit",children:s.jsx(d.Z,{className:"h-4 w-4"})}),s.jsx("button",{onClick:()=>handleDelete(e.id),disabled:u===e.id,className:"text-red-600 hover:text-red-900 p-1 disabled:opacity-50",title:"Delete",children:s.jsx(o.Z,{className:"h-4 w-4"})})]})})]},e.id))})]})})}),m&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,s.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-[705px] mx-4 max-h-[90vh] overflow-y-auto",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[s.jsx("h3",{className:"text-lg font-semibold",children:"Edit Training Invoice"}),s.jsx("button",{onClick:()=>x(null),className:"text-gray-400 hover:text-gray-600",children:"✕"})]}),s.jsx(InvoiceForm,{invoice:m,onSuccess:e=>{t(e),x(null)},onCancel:()=>x(null)})]})})]})}var h=a(9546),g=a(9816),y=a(8168);function AdminTasksTable({invoices:e,onUpdate:t}){let[a,l]=(0,i.useState)(null),handleCheckboxChange=async(e,a,s)=>{l(e);try{let i=await fetch(`/api/training-invoices/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({[a]:s})});if(i.ok){let e=await i.json();e.success&&t(e.data)}}catch(e){console.error("Failed to update task:",e)}finally{l(null)}},getFirstTrainingDate=e=>{if(!e||0===e.length)return"-";let t=e[0];return t.date?(0,r.Z)(new Date(t.date),"dd-MM-yyyy"):"-"};return 0===e.length?s.jsx("div",{className:"card",children:(0,s.jsxs)("div",{className:"text-center py-12",children:[s.jsx(h.Z,{className:"mx-auto h-12 w-12 text-gray-400"}),s.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No training invoices"}),s.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Create your first training invoice to see administrative tasks."})]})}):s.jsx("div",{className:"card overflow-hidden",children:s.jsx("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[s.jsx("thead",{className:"bg-gray-50",children:(0,s.jsxs)("tr",{children:[s.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider min-w-0 flex-1",children:"Training"}),s.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-24",children:"Date"}),s.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-20",children:"Trainer Email"}),s.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-20",children:"Masterclass"}),s.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-16",children:"LMS"}),s.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-20",children:"Navara"}),s.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-20",children:"Catering"}),s.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-20",children:"Trainer Invoice"})]})}),s.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(e=>(0,s.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,s.jsxs)("td",{className:"px-3 py-4",children:[s.jsx("div",{className:"text-sm font-medium text-gray-900 truncate",children:e.training_name}),s.jsx("div",{className:"text-sm text-gray-500 truncate",children:e.customer})]}),s.jsx("td",{className:"px-3 py-4 whitespace-nowrap",children:(0,s.jsxs)("div",{className:"flex items-center text-sm text-gray-900",children:[s.jsx(n.Z,{className:"h-4 w-4 mr-1 text-gray-400"}),getFirstTrainingDate(e.training_dates)]})}),s.jsx("td",{className:"px-3 py-4 whitespace-nowrap",children:s.jsx("button",{onClick:()=>handleCheckboxChange(e.id,"trainer_availability_emailed",!e.trainer_availability_emailed),disabled:a===e.id,className:"flex items-center justify-center text-sm text-gray-900 hover:text-primary-600 disabled:opacity-50",children:e.trainer_availability_emailed?s.jsx(g.Z,{className:"h-5 w-5 text-green-600"}):s.jsx(y.Z,{className:"h-5 w-5 text-gray-400"})})}),s.jsx("td",{className:"px-3 py-4 whitespace-nowrap",children:s.jsx("button",{onClick:()=>handleCheckboxChange(e.id,"masterclass_planning_added",!e.masterclass_planning_added),disabled:a===e.id,className:"flex items-center justify-center text-sm text-gray-900 hover:text-primary-600 disabled:opacity-50",children:e.masterclass_planning_added?s.jsx(g.Z,{className:"h-5 w-5 text-green-600"}):s.jsx(y.Z,{className:"h-5 w-5 text-gray-400"})})}),s.jsx("td",{className:"px-3 py-4 whitespace-nowrap",children:s.jsx("button",{onClick:()=>handleCheckboxChange(e.id,"lms_updated",!e.lms_updated),disabled:a===e.id,className:"flex items-center justify-center text-sm text-gray-900 hover:text-primary-600 disabled:opacity-50",children:e.lms_updated?s.jsx(g.Z,{className:"h-5 w-5 text-green-600"}):s.jsx(y.Z,{className:"h-5 w-5 text-gray-400"})})}),s.jsx("td",{className:"px-3 py-4 whitespace-nowrap",children:s.jsx("button",{onClick:()=>handleCheckboxChange(e.id,"navara_event_agenda_updated",!e.navara_event_agenda_updated),disabled:a===e.id,className:"flex items-center justify-center text-sm text-gray-900 hover:text-primary-600 disabled:opacity-50",children:e.navara_event_agenda_updated?s.jsx(g.Z,{className:"h-5 w-5 text-green-600"}):s.jsx(y.Z,{className:"h-5 w-5 text-gray-400"})})}),s.jsx("td",{className:"px-3 py-4 whitespace-nowrap",children:s.jsx("button",{onClick:()=>handleCheckboxChange(e.id,"catering_ordered",!e.catering_ordered),disabled:a===e.id,className:"flex items-center justify-center text-sm text-gray-900 hover:text-primary-600 disabled:opacity-50",children:e.catering_ordered?s.jsx(g.Z,{className:"h-5 w-5 text-green-600"}):s.jsx(y.Z,{className:"h-5 w-5 text-gray-400"})})}),s.jsx("td",{className:"px-3 py-4 whitespace-nowrap",children:s.jsx("button",{onClick:()=>handleCheckboxChange(e.id,"trainer_invoice_received",!e.trainer_invoice_received),disabled:a===e.id,className:"flex items-center justify-center text-sm text-gray-900 hover:text-primary-600 disabled:opacity-50",children:e.trainer_invoice_received?s.jsx(g.Z,{className:"h-5 w-5 text-green-600"}):s.jsx(y.Z,{className:"h-5 w-5 text-gray-400"})})})]},e.id))})]})})})}var f=a(9518),b=a(2029),j=a(6206);function InvoiceFilters({onFilterChange:e,customers:t}){let[a,r]=(0,i.useState)({search:"",customer:"",dateFrom:"",dateTo:"",minAmount:"",maxAmount:""}),[n,l]=(0,i.useState)(!1),handleFilterChange=(t,s)=>{let i={...a,[t]:s};r(i),e(i)},c=Object.values(a).some(e=>""!==e);return(0,s.jsxs)("div",{className:"card mb-4",children:[s.jsx("div",{className:"flex items-center justify-between mb-4",children:(0,s.jsxs)("div",{className:"flex items-center space-x-4 flex-1",children:[(0,s.jsxs)("div",{className:"relative flex-1 max-w-md",children:[s.jsx(f.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),s.jsx("input",{type:"text",placeholder:"Search training name, invoice number...",value:a.search,onChange:e=>handleFilterChange("search",e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent text-gray-900 bg-white"})]}),(0,s.jsxs)("button",{onClick:()=>l(!n),className:`flex items-center px-3 py-2 rounded-lg border ${n||c?"bg-primary-50 border-primary-200 text-primary-700":"bg-white border-gray-300 text-gray-700 hover:bg-gray-50"}`,children:[s.jsx(b.Z,{className:"h-4 w-4 mr-2"}),"Filters",c&&s.jsx("span",{className:"ml-2 bg-primary-600 text-white text-xs rounded-full px-2 py-1",children:Object.values(a).filter(e=>""!==e).length})]}),c&&(0,s.jsxs)("button",{onClick:()=>{let t={search:"",customer:"",dateFrom:"",dateTo:"",minAmount:"",maxAmount:""};r(t),e(t)},className:"flex items-center px-3 py-2 text-gray-600 hover:text-gray-800",children:[s.jsx(j.Z,{className:"h-4 w-4 mr-1"}),"Clear"]})]})}),n&&(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 pt-4 border-t border-gray-200",children:[(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Customer"}),(0,s.jsxs)("select",{value:a.customer,onChange:e=>handleFilterChange("customer",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent text-gray-900 bg-white",children:[s.jsx("option",{value:"",children:"All customers"}),t.map(e=>s.jsx("option",{value:e,children:e},e))]})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date From"}),s.jsx("input",{type:"date",value:a.dateFrom,onChange:e=>handleFilterChange("dateFrom",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent text-gray-900 bg-white"})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date To"}),s.jsx("input",{type:"date",value:a.dateTo,onChange:e=>handleFilterChange("dateTo",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent text-gray-900 bg-white"})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Min Amount (€)"}),s.jsx("input",{type:"number",placeholder:"0",value:a.minAmount,onChange:e=>handleFilterChange("minAmount",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent text-gray-900 bg-white"})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Max Amount (€)"}),s.jsx("input",{type:"number",placeholder:"∞",value:a.maxAmount,onChange:e=>handleFilterChange("maxAmount",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent text-gray-900 bg-white"})]})]})]})}function AdminFilters({onFilterChange:e,customers:t}){let[a,r]=(0,i.useState)({search:"",customer:"",dateFrom:"",dateTo:"",taskStatus:""}),[n,l]=(0,i.useState)(!1),handleFilterChange=(t,s)=>{let i={...a,[t]:s};r(i),e(i)},c=Object.values(a).some(e=>""!==e);return(0,s.jsxs)("div",{className:"card mb-4",children:[s.jsx("div",{className:"flex items-center justify-between mb-4",children:(0,s.jsxs)("div",{className:"flex items-center space-x-4 flex-1",children:[(0,s.jsxs)("div",{className:"relative flex-1 max-w-md",children:[s.jsx(f.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),s.jsx("input",{type:"text",placeholder:"Search training name...",value:a.search,onChange:e=>handleFilterChange("search",e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent text-gray-900 bg-white"})]}),(0,s.jsxs)("button",{onClick:()=>l(!n),className:`flex items-center px-3 py-2 rounded-lg border ${n||c?"bg-primary-50 border-primary-200 text-primary-700":"bg-white border-gray-300 text-gray-700 hover:bg-gray-50"}`,children:[s.jsx(b.Z,{className:"h-4 w-4 mr-2"}),"Filters",c&&s.jsx("span",{className:"ml-2 bg-primary-600 text-white text-xs rounded-full px-2 py-1",children:Object.values(a).filter(e=>""!==e).length})]}),c&&(0,s.jsxs)("button",{onClick:()=>{let t={search:"",customer:"",dateFrom:"",dateTo:"",taskStatus:""};r(t),e(t)},className:"flex items-center px-3 py-2 text-gray-600 hover:text-gray-800",children:[s.jsx(j.Z,{className:"h-4 w-4 mr-1"}),"Clear"]})]})}),n&&(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 pt-4 border-t border-gray-200",children:[(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Customer"}),(0,s.jsxs)("select",{value:a.customer,onChange:e=>handleFilterChange("customer",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent text-gray-900 bg-white",children:[s.jsx("option",{value:"",children:"All customers"}),t.map(e=>s.jsx("option",{value:e,children:e},e))]})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date From"}),s.jsx("input",{type:"date",value:a.dateFrom,onChange:e=>handleFilterChange("dateFrom",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent text-gray-900 bg-white"})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date To"}),s.jsx("input",{type:"date",value:a.dateTo,onChange:e=>handleFilterChange("dateTo",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent text-gray-900 bg-white"})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Task Status"}),(0,s.jsxs)("select",{value:a.taskStatus,onChange:e=>handleFilterChange("taskStatus",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent text-gray-900 bg-white",children:[s.jsx("option",{value:"",children:"All tasks"}),s.jsx("option",{value:"completed",children:"Completed tasks"}),s.jsx("option",{value:"pending",children:"Pending tasks"})]})]})]})]})}function filterInvoices(e,t){return e.filter(e=>{if(t.search){let a=t.search.toLowerCase(),s=e.training_name.toLowerCase().includes(a)||e.invoice_number&&e.invoice_number.toLowerCase().includes(a)||e.customer.toLowerCase().includes(a);if(!s)return!1}if(t.customer&&e.customer!==t.customer)return!1;if(t.dateFrom||t.dateTo){let a=e.invoice_date?new Date(e.invoice_date):null;if(t.dateFrom&&a){let e=new Date(t.dateFrom);if(a<e)return!1}if(t.dateTo&&a){let e=new Date(t.dateTo);if(e.setHours(23,59,59,999),a>e)return!1}}if(t.minAmount){let a=parseFloat(t.minAmount);if(e.total_invoice_amount<a)return!1}if(t.maxAmount){let a=parseFloat(t.maxAmount);if(e.total_invoice_amount>a)return!1}return!0})}function filterAdminTasks(e,t){return e.filter(e=>{if(t.search){let a=t.search.toLowerCase(),s=e.training_name.toLowerCase().includes(a)||e.customer.toLowerCase().includes(a);if(!s)return!1}if(t.customer&&e.customer!==t.customer)return!1;if(t.dateFrom||t.dateTo){let a=e.training_dates?.[0]?.date?new Date(e.training_dates[0].date):null;if(t.dateFrom&&a){let e=new Date(t.dateFrom);if(a<e)return!1}if(t.dateTo&&a){let e=new Date(t.dateTo);if(e.setHours(23,59,59,999),a>e)return!1}}if(t.taskStatus){let a=[e.trainer_availability_emailed,e.masterclass_planning_added,e.lms_updated,e.navara_event_agenda_updated,e.catering_ordered,e.trainer_invoice_received],s=a.filter(e=>e).length,i=a.length;if("completed"===t.taskStatus&&s<i||"pending"===t.taskStatus&&s===i)return!1}return!0})}function getUniqueCustomers(e){let t=e.map(e=>e.customer);return Array.from(new Set(t)).sort()}var v=a(2385);function Home(){let[e,t]=(0,i.useState)([]),[a,r]=(0,i.useState)(!0),[n,l]=(0,i.useState)(!1),[c,d]=(0,i.useState)(null),[o,m]=(0,i.useState)("invoices"),[x,u]=(0,i.useState)({search:"",customer:"",dateFrom:"",dateTo:"",minAmount:"",maxAmount:""}),[p,y]=(0,i.useState)({search:"",customer:"",dateFrom:"",dateTo:"",taskStatus:""}),fetchInvoices=async()=>{try{r(!0);let e=await fetch("/api/training-invoices"),a=await e.json();a.success?t(a.data):d(a.error||"Failed to fetch invoices")}catch(e){d("Failed to fetch invoices")}finally{r(!1)}};(0,i.useEffect)(()=>{fetchInvoices()},[]);let handleInvoiceUpdated=a=>{t(e.map(e=>e.id===a.id?a:e))},f=getUniqueCustomers(e),b="invoices"===o?filterInvoices(e,x):filterAdminTasks(e,p),j=e.reduce((e,t)=>e+t.total_invoice_amount,0),N=e.length;return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsx("div",{className:"card",children:(0,s.jsxs)("div",{className:"flex items-center",children:[s.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:s.jsx(h.Z,{className:"h-6 w-6 text-green-600"})}),(0,s.jsxs)("div",{className:"ml-4",children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Trainings"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:N})]})]})}),s.jsx("div",{className:"card",children:(0,s.jsxs)("div",{className:"flex items-center",children:[s.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:s.jsx(h.Z,{className:"h-6 w-6 text-blue-600"})}),(0,s.jsxs)("div",{className:"ml-4",children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Revenue"}),(0,s.jsxs)("p",{className:"text-2xl font-bold text-gray-900",children:["€",j.toLocaleString("nl-NL",{minimumFractionDigits:2})]})]})]})})]}),(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsxs)("div",{className:"flex space-x-8",children:[s.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Training Management"}),(0,s.jsxs)("div",{className:"flex border-b border-gray-200",children:[(0,s.jsxs)("button",{className:`px-4 py-2 -mb-px border-b-2 font-medium text-sm focus:outline-none ${"invoices"===o?"border-primary-600 text-primary-700":"border-transparent text-gray-500 hover:text-gray-700"}`,onClick:()=>m("invoices"),children:[s.jsx(h.Z,{className:"h-4 w-4 inline mr-2"}),"Invoices"]}),(0,s.jsxs)("button",{className:`px-4 py-2 -mb-px border-b-2 font-medium text-sm focus:outline-none ${"admin"===o?"border-primary-600 text-primary-700":"border-transparent text-gray-500 hover:text-gray-700"}`,onClick:()=>m("admin"),children:[s.jsx(g.Z,{className:"h-4 w-4 inline mr-2"}),"Administrative Tasks"]})]})]}),(0,s.jsxs)("button",{onClick:()=>l(!0),className:"btn-primary flex items-center",children:[s.jsx(v.Z,{className:"h-4 w-4 mr-2"}),"Add Training Invoice"]})]}),c&&s.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:s.jsx("p",{className:"text-red-800",children:c})}),n&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,s.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-[705px] mx-4 max-h-[90vh] overflow-y-auto",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[s.jsx("h3",{className:"text-lg font-semibold",children:"Add New Training Invoice"}),s.jsx("button",{onClick:()=>l(!1),className:"text-gray-400 hover:text-gray-600",children:"✕"})]}),s.jsx(InvoiceForm,{onSuccess:a=>{t([a,...e]),l(!1)},onCancel:()=>l(!1)})]})}),a?s.jsx("div",{className:"card",children:(0,s.jsxs)("div",{className:"flex items-center justify-center py-8",children:[s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"}),s.jsx("span",{className:"ml-2 text-gray-600",children:"Loading invoices..."})]})}):(0,s.jsxs)(s.Fragment,{children:["invoices"===o&&(0,s.jsxs)(s.Fragment,{children:[s.jsx(InvoiceFilters,{onFilterChange:u,customers:f}),s.jsx(InvoiceList,{invoices:b,onUpdate:handleInvoiceUpdated,onDelete:a=>{t(e.filter(e=>e.id!==a))}})]}),"admin"===o&&(0,s.jsxs)(s.Fragment,{children:[s.jsx(AdminFilters,{onFilterChange:y,customers:f}),s.jsx(AdminTasksTable,{invoices:b,onUpdate:handleInvoiceUpdated})]})]})]})}},8203:(e,t,a)=>{"use strict";a.r(t),a.d(t,{$$typeof:()=>n,__esModule:()=>r,default:()=>c});var s=a(5153);let i=(0,s.createProxy)(String.raw`C:\Users\wesle\OneDrive\Documenten\Wesley code\Finance\src\app\page.tsx`),{__esModule:r,$$typeof:n}=i,l=i.default,c=l}};var t=require("../webpack-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),a=t.X(0,[164,671,703],()=>__webpack_exec__(2390));module.exports=a})();