"use strict";(()=>{var e={};e.id=210,e.ids=[210],e.modules={8802:e=>{e.exports=require("bcrypt")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},8678:e=>{e.exports=import("pg")},6341:(e,i,n)=>{n.a(e,async(e,t)=>{try{n.r(i),n.d(i,{headerHooks:()=>d,originalPathname:()=>m,requestAsyncStorage:()=>u,routeModule:()=>c,serverHooks:()=>l,staticGenerationAsyncStorage:()=>_,staticGenerationBailout:()=>p});var a=n(884),r=n(6132),o=n(6438),s=e([o]);o=(s.then?(await s)():s)[0];let c=new a.AppRouteRouteModule({definition:{kind:r.x.APP_ROUTE,page:"/api/training-invoices/route",pathname:"/api/training-invoices",filename:"route",bundlePath:"app/api/training-invoices/route"},resolvedPagePath:"C:\\Users\\wesle\\OneDrive\\Documenten\\Wesley code\\Finance\\src\\app\\api\\training-invoices\\route.ts",nextConfigOutput:"",userland:o}),{requestAsyncStorage:u,staticGenerationAsyncStorage:_,serverHooks:l,headerHooks:d,staticGenerationBailout:p}=c,m="/api/training-invoices/route";t()}catch(e){t(e)}})},6438:(e,i,n)=>{n.a(e,async(e,t)=>{try{n.r(i),n.d(i,{GET:()=>GET,POST:()=>POST});var a=n(5798),r=n(5438),o=n(1538),s=n(1045),c=e([r]);r=(c.then?(await c)():c)[0];let u=o.Ry({invoice_number:o.Z_().optional(),invoice_date:o.Z_().optional(),customer:o.Z_().min(1,"Customer is required"),training_name:o.Z_().min(1,"Training name is required"),training_dates:o.IX(o.Ry({date:o.Z_().min(1,"Date is required"),start_time:o.Z_().min(1,"Start time is required"),end_time:o.Z_().min(1,"End time is required"),room_rent_option_id:o.Rx().nullable().optional(),lunch_catering_option_id:o.Rx().nullable().optional(),dinner_catering_option_id:o.Rx().nullable().optional()})).min(1,"At least one date is required"),trainer_costs:o.Rx().min(0,"Trainer costs must be non-negative"),office_costs:o.Rx().min(0,"Office costs must be non-negative"),margin_percentage:o.Rx().min(0,"Margin percentage must be non-negative"),total_invoice_amount:o.Rx().min(0,"Total invoice amount must be non-negative"),trainer_availability_emailed:o.O7().optional(),masterclass_planning_added:o.O7().optional(),lms_updated:o.O7().optional(),navara_event_agenda_updated:o.O7().optional(),catering_ordered:o.O7().optional(),trainer_invoice_received:o.O7().optional()});async function GET(){try{let e=await (0,r.j9)();return a.Z.json({success:!0,data:e})}catch(e){return console.error("Error fetching training invoices:",e),a.Z.json({success:!1,error:"Failed to fetch training invoices"},{status:500})}}async function POST(e){try{let i=await e.json(),n=u.parse(i),t=Array.from(new Set(n.training_dates.map(e=>e.date))),o=t.length,s=n.total_invoice_amount;s||(s=(0,r.p8)(n.trainer_costs,n.office_costs,n.margin_percentage));let c=await (0,r.HY)({...n,invoice_number:n.invoice_number??"",training_dates:n.training_dates,duration_days:o,total_invoice_amount:s});return a.Z.json({success:!0,data:c},{status:201})}catch(e){if(console.error("Error creating training invoice:",e),e instanceof s.jm)return a.Z.json({success:!1,error:"Validation error",details:e.errors},{status:400});return a.Z.json({success:!1,error:"Failed to create training invoice"},{status:500})}}t()}catch(e){t(e)}})}};var i=require("../../../webpack-runtime.js");i.C(e);var __webpack_exec__=e=>i(i.s=e),n=i.X(0,[997,538,438],()=>__webpack_exec__(6341));module.exports=n})();