"use strict";exports.id=788,exports.ids=[788],exports.modules={5788:(e,r,n)=>{n.a(e,async(e,t)=>{try{n.d(r,{AW:()=>getAllUsers,Gv:()=>verifyPassword,MH:()=>requireRole,Ml:()=>findUserByUsername,Nq:()=>updateUser,RA:()=>generateToken,h8:()=>deleteUser,r4:()=>createUser,tj:()=>findUserById,ts:()=>getCurrentUser});var s=n(5798),a=n(4596),i=n(6721),u=n(5438),o=n(8802),l=n.n(o),c=e([u]);u=(c.then?(await c)():c)[0];let d=process.env.JWT_SECRET||"your-secret-key-change-in-production";async function hashPassword(e){return await l().hash(e,10)}async function verifyPassword(e,r){return await l().compare(e,r)}function generateToken(e){return(0,i.sign)({id:e.id,username:e.username,email:e.email,role:e.role,name:e.name},d,{expiresIn:"24h"})}function verifyToken(e){try{return(0,i.verify)(e,d)}catch(e){return null}}function getSessionToken(){let e=(0,a.cookies)();return e.get("session_token")?.value||null}function getCurrentUser(){let e=getSessionToken();if(!e)return null;let r=verifyToken(e);return r?{id:r.id,username:r.username,email:r.email,role:r.role,name:r.name,created_at:r.created_at,updated_at:r.updated_at}:null}function requireRole(e){return r=>async n=>{let t=getCurrentUser();return t?e.includes(t.role)?r(n,t):s.Z.json({error:"Insufficient permissions"},{status:403}):s.Z.json({error:"Unauthorized"},{status:401})}}async function findUserByUsername(e){let r=await (0,u.dQ)(e);return r||null}async function findUserById(e){let r=await (0,u.GA)(e);return r||null}async function createUser(e){let r=await hashPassword(e.password),n=await (0,u.r4)({...e,password:r});return n}async function getAllUsers(){return await (0,u.AW)()}async function updateUser(e,r){let n=await (0,u.Nq)(e,r);return n||null}async function deleteUser(e){return await (0,u.h8)(e)}new Date().toISOString(),new Date().toISOString(),t()}catch(e){t(e)}})}};